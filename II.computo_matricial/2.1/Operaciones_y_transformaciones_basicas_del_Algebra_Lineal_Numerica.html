

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2 Eigenvalores y eigenvectores" href="../2.2/Eigenvalores_y_eigenvectores.html" />
    <link rel="prev" title="1.7 Integración Numérica" href="../../I.computo_cientifico/1.7/Integracion_numerica.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas.html">
   3.2 Algoritmos de descenso y búsqueda de línea para funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ecuaciones_no_lineales.html">
   3.3 Ecuaciones no lineales
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectoriales">
   Vectoriales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matriciales">
   Matriciales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformaciones-de-gauss">
   Transformaciones de Gauss
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-transformaciones-de-gauss-a-un-vector">
     Ejemplo aplicando transformaciones de Gauss a un vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-transformaciones-de-gauss-a-una-matriz">
     Ejemplo aplicando transformaciones de Gauss a una matriz
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matriz-ortogonal-y-matriz-con-columnas-ortonormales">
   Matriz ortogonal y matriz con columnas ortonormales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformaciones-de-reflexion">
   Transformaciones de reflexión
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reflectores-de-householder">
     Reflectores de Householder
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-reflectores-de-householder-a-un-vector">
     Ejemplo aplicando reflectores de Householder a un vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Ejemplo aplicando reflectores de Householder a un vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cual-definicion-del-vector-de-householder-usar">
     ¿Cuál definición del vector de Householder usar?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-reflectores-de-householder-a-una-matriz">
     Ejemplo aplicando reflectores de Householder a una matriz
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformaciones-de-rotacion">
   Transformaciones de rotación
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-rotaciones-givens-a-un-vector">
     Ejemplo aplicando rotaciones Givens a un vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-aplicando-rotaciones-givens-a-una-matriz">
     Ejemplo aplicando rotaciones Givens a una matriz
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="operaciones-y-transformaciones-basicas-del-algebra-lineal-numerica">
<span id="otbaln"></span><h1>2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica<a class="headerlink" href="#operaciones-y-transformaciones-basicas-del-algebra-lineal-numerica" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/fyqwiqasqaa3wlt/3.1.1.Multiplicacion_de_matrices_y_estructura_de_datos.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/jwu8lu4r14pb7ut/3.2.1.Sistemas_de_ecuaciones_lineales_eliminacion_Gaussiana_y_factorizacion_LU.pdf?dl=0">liga2</a> y <a class="reference external" href="https://www.dropbox.com/s/s4ch0ww1687pl76/3.2.2.Factorizaciones_matriciales_SVD_Cholesky_QR.pdf?dl=0">liga3</a>.</p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Entenderá cómo utilizar transformaciones típicas en el álgebra lineal numérica en la que se basan muchos de los algoritmos del análisis numérico. En específico aprenderá cómo aplicar las transformaciones de Gauss, reflexiones de Householder y rotaciones Givens a vectores y matrices.</p></li>
<li><p>Se familizarizará con la notación vectorial y matricial de las operaciones básicas del álgebra lineal numérica.</p></li>
</ul>
</div>
<p>Las operaciones básicas del Álgebra Lineal Numérica podemos dividirlas en vectoriales y matriciales.</p>
<div class="section" id="vectoriales">
<h2>Vectoriales<a class="headerlink" href="#vectoriales" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Transponer:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{n \times 1}  \rightarrow \mathbb{R} ^{1 \times n}\)</span>: <span class="math notranslate nohighlight">\(y = x^T\)</span> entonces <span class="math notranslate nohighlight">\(x = \left[ \begin{array}{c} x_1 \\ x_2 \\ \vdots \\ x_n \end{array} \right ]\)</span> y se tiene: <span class="math notranslate nohighlight">\(y = x^T = [x_1, x_2, \dots, x_n].\)</span></p></li>
</ul>
<ul class="simple">
<li><p><strong>Suma:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n  \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(z = x + y\)</span> entonces <span class="math notranslate nohighlight">\(z_i = x_i + y_i\)</span></p></li>
<li><p><strong>Multiplicación por un escalar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R} \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(y = \alpha x\)</span> entonces <span class="math notranslate nohighlight">\(y_i = \alpha x_i\)</span>.</p></li>
<li><p><strong>Producto interno estándar o producto punto:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}\)</span>: <span class="math notranslate nohighlight">\(c = x^Ty\)</span> entonces <span class="math notranslate nohighlight">\(c = \displaystyle \sum_{i=1}^n x_i y_i\)</span>.</p></li>
<li><p><strong>Multiplicación <em>point wise:</em></strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(z = x.*y\)</span> entonces <span class="math notranslate nohighlight">\(z_i = x_i y_i\)</span>.</p></li>
<li><p><strong>División <em>point wise:</em></strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(z = x./y\)</span> entonces <span class="math notranslate nohighlight">\(z_i = x_i /y_i\)</span> con <span class="math notranslate nohighlight">\(y_i \neq 0\)</span>.</p></li>
<li><p><strong>Producto exterior o <em>outer product</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^{n \times n}\)</span>: <span class="math notranslate nohighlight">\(A = xy^T\)</span> entonces <span class="math notranslate nohighlight">\(A[i, :] = x_i y^T\)</span> con <span class="math notranslate nohighlight">\(A[i,:]\)</span> el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
</ul>
</div>
<div class="section" id="matriciales">
<h2>Matriciales<a class="headerlink" href="#matriciales" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Transponer:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{n \times m}\)</span>: <span class="math notranslate nohighlight">\(C = A^T\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ji}\)</span>.</p></li>
<li><p><strong>Sumar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A + B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij} + b_{ij}\)</span>.</p></li>
<li><p><strong>Multiplicación por un escalar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = \alpha A\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = \alpha a_{ij}\)</span></p></li>
<li><p><strong>Multiplicación por un vector:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}\)</span>: <span class="math notranslate nohighlight">\(y = Ax\)</span> entonces <span class="math notranslate nohighlight">\(y_i = \displaystyle \sum_{j=1}^n a_{ij}x_j\)</span>.</p></li>
<li><p><strong>Multiplicación entre matrices:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times k} \times \mathbb{R}^{k \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = AB\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = \displaystyle \sum_{r=1}^k a_{ir}b_{rj}\)</span>.</p>
<ul>
<li><p>Para esta necesitaríamos hacer tres ciclos “for” para codificar esta operación.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p><strong>Multiplicación <em>point wise</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A.*B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij}b_{ij}\)</span>.</p></li>
<li><p><strong>División <em>point wise</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A./B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij}/b_{ij}\)</span> con <span class="math notranslate nohighlight">\(b_{ij} \neq 0\)</span>.</p></li>
</ul>
<p><strong>Como ejemplos de transformaciones básicas del Álgebra Lineal Numérica se encuentran:</strong></p>
</div>
<div class="section" id="transformaciones-de-gauss">
<span id="tgauss"></span><h2>Transformaciones de Gauss<a class="headerlink" href="#transformaciones-de-gauss" title="Permalink to this headline">¶</a></h2>
<p>En esta sección suponemos que <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> y <span class="math notranslate nohighlight">\(A\)</span> es una matriz con entradas <span class="math notranslate nohighlight">\(a_{ij} \in \mathbb{R}^{n \times n} \forall i,j=1,2,\dots,n\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Como ejemplo de vector canónico tenemos: <span class="math notranslate nohighlight">\(e_1=(1,0)^T\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> o <span class="math notranslate nohighlight">\(e_3 = (0,0,1,0,0)\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^5\)</span>.</p>
</div>
<p>Considérese al vector <span class="math notranslate nohighlight">\(a \in \mathbb{R}^{n}\)</span> y <span class="math notranslate nohighlight">\(e_k \in \mathbb{R}^n\)</span> el <span class="math notranslate nohighlight">\(k\)</span>-ésimo vector canónico: vector con un <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(k\)</span> y ceros en las entradas restantes.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Una transformación de Gauss está definida de forma general como <span class="math notranslate nohighlight">\(L_k = I_n - \ell_ke_k^T\)</span> con <span class="math notranslate nohighlight">\(\ell_k = (0,0,\dots,\ell_{k+1,k},\dots,\ell_{n,k})^T\)</span> y <span class="math notranslate nohighlight">\(\ell_{i,k}=\frac{a_{ik}}{a_{kk}} \forall i=k+1,\dots,n\)</span>.</p>
<p><span class="math notranslate nohighlight">\(a_{kk}\)</span> se le nombra <strong>pivote</strong> y <strong>debe ser diferente de cero</strong>.</p>
</div>
<p>Las transformaciones de Gauss se utilizan para hacer ceros por debajo del <strong>pivote</strong>.</p>
<div class="section" id="ejemplo-aplicando-transformaciones-de-gauss-a-un-vector">
<span id="eg1"></span><h3>Ejemplo aplicando transformaciones de Gauss a un vector<a class="headerlink" href="#ejemplo-aplicando-transformaciones-de-gauss-a-un-vector" title="Permalink to this headline">¶</a></h3>
<p>Considérese al vector <span class="math notranslate nohighlight">\(a=(-2,3,4)^T\)</span>. Definir una transformación de Gauss para hacer ceros por debajo de <span class="math notranslate nohighlight">\(a_1\)</span> y otra transformación de Gauss para hacer cero la entrada <span class="math notranslate nohighlight">\(a_3\)</span></p>
<p><strong>Solución:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>a)Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_1 = -2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\ell_1=(0, \frac{a_2}{a_1}, \frac{a_3}{a_1})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_1\)</span> pues se desea hacer ceros en las entradas debajo de la primera.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la transformación de Gauss, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1a = a - \ell_1 e_1^Ta\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1_a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-2.  0.  0.]
</pre></div>
</div>
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_1 a\)</span> si se construye <span class="math notranslate nohighlight">\(L_1\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_1 = I_3 - \ell_1 e_1^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[1.  0.  0. ]
 [1.5 1.  0. ]
 [2.  0.  1. ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span><span class="nd">@a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-2.  0.  0.]
</pre></div>
</div>
</div>
</div>
<p>b) Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_2 = 3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\ell_2=(0, 0, \frac{a_3}{a_2})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_2\)</span> pues se desea hacer ceros en las entradas debajo de la segunda.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la transformación de Gauss, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_2\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_2a = a - \ell_2 e_2^Ta\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-</span><span class="n">l2</span><span class="o">*</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L2_a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-2.  3.  0.]
</pre></div>
</div>
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_2 a\)</span> si se construye <span class="math notranslate nohighlight">\(L_2\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_2 = I_3 - \ell_2 e_2^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 1.     0.     0.   ]
 [ 0.     1.     0.   ]
 [ 0.    -1.333  1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L2</span><span class="nd">@a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-2.  3.  0.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ejemplo-aplicando-transformaciones-de-gauss-a-una-matriz">
<span id="eg2"></span><h3>Ejemplo aplicando transformaciones de Gauss a una matriz<a class="headerlink" href="#ejemplo-aplicando-transformaciones-de-gauss-a-una-matriz" title="Permalink to this headline">¶</a></h3>
<p>Si tenemos una matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 3}\)</span> y queremos hacer ceros por debajo de su <strong>diagonal</strong> y tener una forma <strong>triangular superior</strong>, realizamos los productos matriciales:</p>
<div class="math notranslate nohighlight">
\[L_2 L_1 A\]</div>
<p>donde: <span class="math notranslate nohighlight">\(L_1, L_2\)</span> son transformaciones de Gauss.</p>
<p>Posterior a realizar el producto <span class="math notranslate nohighlight">\(L_2 L_1 A\)</span> se obtiene una <strong>matriz triangular superior:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
L_2L_1A = \left [
\begin{array}{ccc}
* &amp; * &amp; *\\
0 &amp; * &amp; * \\
0 &amp; 0 &amp; * 
\end{array}
\right ]
\end{split}\]</div>
<p><strong>Ejemplo:</strong></p>
<p>a) Utilizando <span class="math notranslate nohighlight">\(L_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 4.  5. -7.]
 [ 3.  0.  8.]]
</pre></div>
</div>
</div>
</div>
<p>Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_{11} = -1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\ell_1=(0, \frac{a_{21}}{a_{11}}, \frac{a_{31}}{a_{11}})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la transformación de Gauss, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1 A[1:3,1] = A[1:3,1] - \ell_1 e_1^T A[1:3,1]\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1_A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-1.  0.  0.]
</pre></div>
</div>
</div>
</div>
<p><strong>Y se debe aplicar <span class="math notranslate nohighlight">\(L_1\)</span> a las columnas número 2 y 3 de <span class="math notranslate nohighlight">\(A\)</span> para completar el producto <span class="math notranslate nohighlight">\(L_1A\)</span>:</strong></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aplicando <span class="math notranslate nohighlight">\(L_1\)</span> a la segunda columna de <span class="math notranslate nohighlight">\(A\)</span>: <span class="math notranslate nohighlight">\(A[1:3,2]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1_A_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 2. 13.  6.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aplicando <span class="math notranslate nohighlight">\(L_1\)</span> a la tercer columna de <span class="math notranslate nohighlight">\(A\)</span>: <span class="math notranslate nohighlight">\(A[1:3,3]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_3</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1_A_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 5. 13. 23.]
</pre></div>
</div>
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_1 A\)</span> si se construye <span class="math notranslate nohighlight">\(L_1\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_1 = I_3 - \ell_1 e_1^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0.]
 [4. 1. 0.]
 [3. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 0. 13. 13.]
 [ 0.  6. 23.]]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Al aplicar <span class="math notranslate nohighlight">\(L_1\)</span> a la primer columna de <span class="math notranslate nohighlight">\(A\)</span> <strong>siempre</strong> obtenemos ceros por debajo del pivote que en este caso es <span class="math notranslate nohighlight">\(a_{11}\)</span>.</p>
</div>
<p id="eg2-1"><strong>Después de hacer la multiplicación <span class="math notranslate nohighlight">\(L_1A\)</span> en cualquiera de los dos casos (construyendo o no explícitamente <span class="math notranslate nohighlight">\(L_1\)</span>) no se modifica el primer renglón de <span class="math notranslate nohighlight">\(A\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 4.  5. -7.]
 [ 3.  0.  8.]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Este es el primer renglón de <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-1.  2.  5.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Tomando el primer renglón del producto <span class="math notranslate nohighlight">\(L_1A\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">((</span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-1.  2.  5.]
</pre></div>
</div>
</div>
</div>
<p><strong>por lo que la multiplicación <span class="math notranslate nohighlight">\(L_1A\)</span> entonces modifica del segundo renglón de <span class="math notranslate nohighlight">\(A\)</span> en adelante y de la segunda columna de <span class="math notranslate nohighlight">\(A\)</span> en adelante.</strong></p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Dada la forma de <span class="math notranslate nohighlight">\(L_1 = I_3 - \ell_1e_1^T\)</span>, al hacer la multiplicación por la segunda y tercer columna de <span class="math notranslate nohighlight">\(A\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[e_1^T A[1:3,2] = A[0,2]\]</div>
<div class="math notranslate nohighlight">
\[e_1^T A[1:3,3] = A[0,3]\]</div>
<p>respectivamente.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El resultado de este producto es un escalar.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El resultado de este producto es un escalar.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>y puede escribirse de forma compacta:</p>
<div class="math notranslate nohighlight">
\[e_1^T A[1:3,2:3] = A[0, 2:3]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="c1">#observe that we have to use 2+1=3 as the second number after &quot;:&quot; in 1:3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[2. 5.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span> <span class="c1">#also we could have use this statement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[2. 5.]
</pre></div>
</div>
</div>
</div>
<p>Entonces los productos <span class="math notranslate nohighlight">\(\ell_1 e_1^T A[:,2]\)</span> y <span class="math notranslate nohighlight">\(\ell_1 e_1^T A[:,3]\)</span> quedan respectivamente como:</p>
<div class="math notranslate nohighlight">
\[\ell_1A[0, 2]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 0. -8. -6.]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\ell_1A[0,3]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[  0. -20. -15.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En los dos cálculos anteriores, las primeras entradas son iguales a <span class="math notranslate nohighlight">\(0\)</span> por lo que es consistente con el hecho que únicamente se modifican dos entradas de la segunda y tercer columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div>
<p>De forma compacta y aprovechando funciones en <em>NumPy</em> como <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.outer.html">np.outer</a> se puede calcular lo anterior como:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ -8. -20.]
 [ -6. -15.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]))</span> <span class="c1">#also we could have use this statement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ -8. -20.]
 [ -6. -15.]]
</pre></div>
</div>
</div>
</div>
<p>Y finalmente la aplicación de <span class="math notranslate nohighlight">\(L_1\)</span> al segundo renglón y segunda columna en adelante de <span class="math notranslate nohighlight">\(A\)</span> queda:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la transformación de Gauss, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1 A = A - \ell_1 e_1^T A\)</span> y podemos aprovechar lo anterior para sólo operar de la segunda columna y segundo renglón en adelante.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[13. 13.]
 [ 6. 23.]]
</pre></div>
</div>
</div>
</div>
<p>Compárese con:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 0. 13. 13.]
 [ 0.  6. 23.]]
</pre></div>
</div>
</div>
</div>
<p>Entonces sólo falta colocar el primer renglón y primera columna al producto. Para esto combinamos columnas y renglones en <em>numpy</em> con <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html">column_stack</a> y <em>row_stack</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="n">number_of_zeros</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span>
<span class="n">A_aux_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_zeros</span><span class="p">),</span> <span class="n">A_aux</span><span class="p">))</span> <span class="c1"># stack two zeros</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A_aux_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0. 13. 13.]
 [ 0.  6. 23.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">A_aux_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A_aux_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 0. 13. 13.]
 [ 0.  6. 23.]]
</pre></div>
</div>
</div>
</div>
<p>que es el resultado de:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  2.  5.]
 [ 0. 13. 13.]
 [ 0.  6. 23.]]
</pre></div>
</div>
</div>
</div>
<p><strong>Lo que falta para obtener una matriz triangular superior es hacer la multiplicación <span class="math notranslate nohighlight">\(L_2L_1A\)</span>.</strong> Para este caso la matriz <span class="math notranslate nohighlight">\(L_2=I_3 - \ell_2e_2^T\)</span> utiliza <span class="math notranslate nohighlight">\(\ell_2 = \left( 0, 0, \frac{a^{(1)}_{32}}{a^{(1)}_{22}} \right )^T\)</span> donde: <span class="math notranslate nohighlight">\(a^{(1)}_{ij}\)</span> son las entradas de <span class="math notranslate nohighlight">\(A^{(1)} = L_1A^{(0)}\)</span> y <span class="math notranslate nohighlight">\(A^{(0)}=A\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Calcular el producto <span class="math notranslate nohighlight">\(L_2 L_1 A\)</span> para la matriz anterior y para la matriz:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left [
\begin{array}{ccc}
1 &amp; 4 &amp; -2 \\
-3 &amp; 9 &amp; 8 \\
5 &amp; 1 &amp; -6
\end{array}
\right]
\end{split}\]</div>
<p>tomando en cuenta que en este caso <span class="math notranslate nohighlight">\(L_2\)</span> sólo opera del segundo renglón y segunda columna en adelante:</p>
<img src="https://dl.dropboxusercontent.com/s/su4z0obupk95vql/transf_Gauss_outer_product.png?dl=0" heigth="550" width="550">
<p>y obtener una matriz triangular superior en cada ejercicio.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Las transformaciones de Gauss se utilizan para la fase de eliminación del método de eliminación Gaussiana o también llamada factorización <span class="math notranslate nohighlight">\(LU\)</span>. Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a>.</p></li>
<li><p>La factorización <span class="math notranslate nohighlight">\(P, L, U\)</span> que es la <span class="math notranslate nohighlight">\(LU\)</span> con permutaciones por pivoteo parcial es un método estable numéricamente respecto al redondeo en la práctica pero inestable en la teoría.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="matriz-ortogonal-y-matriz-con-columnas-ortonormales">
<span id="matortmatcolortono"></span><h2>Matriz ortogonal y matriz con columnas ortonormales<a class="headerlink" href="#matriz-ortogonal-y-matriz-con-columnas-ortonormales" title="Permalink to this headline">¶</a></h2>
<p>Un conjunto de vectores <span class="math notranslate nohighlight">\(\{x_1, \dots, x_p\}\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> (<span class="math notranslate nohighlight">\(x_i \in \mathbb{R}^m\)</span>)es ortogonal si <span class="math notranslate nohighlight">\(x_i^Tx_j=0\)</span> <span class="math notranslate nohighlight">\(\forall i\neq j\)</span>. Por ejemplo, para un conjunto de <span class="math notranslate nohighlight">\(2\)</span> vectores <span class="math notranslate nohighlight">\(x_1,x_2\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> esto se visualiza:</p>
<img src="https://dl.dropboxusercontent.com/s/cekagqnxe0grvu4/vectores_ortogonales.png?dl=0" heigth="550" width="550">
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Si el conjunto <span class="math notranslate nohighlight">\(\{x_1,\dots,x_n\}\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> satisface <span class="math notranslate nohighlight">\(x_i^Tx_j= \delta_{ij}= \begin{cases}
1 &amp;\text{ si } i=j,\\
0 &amp;\text{ si } i\neq j
\end{cases}\)</span>, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker_delta</a> se le nombra conjunto <strong>ortonormal</strong>, esto es, constituye un conjunto ortogonal y cada elemento del conjunto tiene norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana igual a <span class="math notranslate nohighlight">\(1\)</span>: <span class="math notranslate nohighlight">\(||x_i||_2 = 1, \forall i=1,\dots,n\)</span>.</p>
<ul>
<li><p>Si definimos a la matriz <span class="math notranslate nohighlight">\(X\)</span> con columnas dadas por cada uno de los vectores del conjunto <span class="math notranslate nohighlight">\(\{x_1,\dots, x_n\}\)</span>: <span class="math notranslate nohighlight">\(X=(x_1, \dots , x_n) \in \mathbb{R}^{m \times n}\)</span> entonces la propiedad de que cada par de columnas satisfaga <span class="math notranslate nohighlight">\(x_i^Tx_j=\delta_{ij}\)</span> se puede escribir en notación matricial como <span class="math notranslate nohighlight">\(X^TX = I_n\)</span> con <span class="math notranslate nohighlight">\(I_n\)</span> la matriz identidad de tamaño <span class="math notranslate nohighlight">\(n\)</span> si <span class="math notranslate nohighlight">\(n \leq m\)</span> o bien <span class="math notranslate nohighlight">\(XX^T=I_m\)</span> si <span class="math notranslate nohighlight">\(m \leq n\)</span>. A la matriz <span class="math notranslate nohighlight">\(X\)</span> se le nombra <strong>matriz con columnas ortonormales</strong>.</p></li>
<li><p>Si cada <span class="math notranslate nohighlight">\(x_i\)</span> está en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> (en lugar de <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>) entonces construímos a la matriz <span class="math notranslate nohighlight">\(X\)</span> como el punto anterior con la diferencia que <span class="math notranslate nohighlight">\(X \in \mathbb{R}^{n \times n}\)</span>. En este caso <span class="math notranslate nohighlight">\(X\)</span> se le nombra <strong>matriz ortogonal</strong>.</p></li>
</ul>
</li>
<li><p>Entre las propiedades más importantes de las matrices ortogonales o con columnas ortonormales es que son isometrías bajo la norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana y multiplicar por tales matrices es estable numéricamente bajo el redondeo, ver <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a>.</p></li>
</ul>
</div>
</div>
<div class="section" id="transformaciones-de-reflexion">
<span id="tref"></span><h2>Transformaciones de reflexión<a class="headerlink" href="#transformaciones-de-reflexion" title="Permalink to this headline">¶</a></h2>
<p>En esta sección suponemos que <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <span class="math notranslate nohighlight">\(A\)</span> es una matriz con entradas <span class="math notranslate nohighlight">\(a_{ij} \in \mathbb{R}^{m \times n} \forall i=1,2,\dots,m, j=1, 2, \dots, n\)</span>.</p>
<div class="section" id="reflectores-de-householder">
<h3>Reflectores de Householder<a class="headerlink" href="#reflectores-de-householder" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda que <span class="math notranslate nohighlight">\(u^\perp = \{x \in \mathbb{R}^m| u^Tx=0\}\)</span> es un subespacio de <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> de dimensión <span class="math notranslate nohighlight">\(m-1\)</span> y es el complemento ortogonal de <span class="math notranslate nohighlight">\(u\)</span>.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Las reflexiones de Householder son matrices <strong>simétricas, ortogonales</strong> y se construyen a partir de un vector <span class="math notranslate nohighlight">\(v \neq 0\)</span> definiendo:</p>
<div class="math notranslate nohighlight">
\[R = I_m-\beta v v^T\]</div>
<p>con <span class="math notranslate nohighlight">\(v \in \mathbb{R}^m - \{0\}\)</span> y <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span>. El vector <span class="math notranslate nohighlight">\(v\)</span> se llama <strong>vector de Householder</strong>. La multiplicación <span class="math notranslate nohighlight">\(Rx\)</span> representa la reflexión del vector <span class="math notranslate nohighlight">\(x \in \mathbb{R}^m\)</span> a través del hiperplano <span class="math notranslate nohighlight">\(v^\perp\)</span>.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Algunas propiedades de las reflexiones de Householder son: <span class="math notranslate nohighlight">\(R^TR = R^2 = I_m\)</span>, <span class="math notranslate nohighlight">\(R^{-1}=R\)</span>, <span class="math notranslate nohighlight">\(det(R)=-1\)</span>.</p>
</div>
<div class="sidebar">
<p class="sidebar-title">Proyector ortogonal elemental</p>
<p>En este dibujo se utiliza el <strong>proyector ortogonal elemental</strong> sobre el complemento ortogonal <span class="math notranslate nohighlight">\(u^\perp\)</span> definido como: <span class="math notranslate nohighlight">\(P=I_m- u u^T\)</span> y <span class="math notranslate nohighlight">\(Px\)</span> es la proyección ortogonal de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(u^\perp\)</span> . Los proyectores ortogonales elementales <strong>no</strong> son matrices ortogonales, son singulares, son simétricas y <span class="math notranslate nohighlight">\(P^2=P\)</span>. El proyector ortogonal elemental de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(u^\perp\)</span> tienen <span class="math notranslate nohighlight">\(rank\)</span> igual a <span class="math notranslate nohighlight">\(m-1\)</span> y el proyector ortogonal de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(span\{u\}\)</span> definido por <span class="math notranslate nohighlight">\(I_m-P=uu^T\)</span> tienen <span class="math notranslate nohighlight">\(rank\)</span> igual a <span class="math notranslate nohighlight">\(1\)</span>.</p>
<img src="https://dl.dropboxusercontent.com/s/itjn9edajx4g2ql/elementary_projector_drawing.png?dl=0" heigth="350" width="350">
<p>Recuerda que <span class="math notranslate nohighlight">\(span\{u\}\)</span> es el conjunto generado por <span class="math notranslate nohighlight">\(u\)</span>. Se define como el conjunto de combinaciones lineales de <span class="math notranslate nohighlight">\(u\)</span>: <span class="math notranslate nohighlight">\(span\{u\} = \left \{\displaystyle \sum_{i=1}^m k_i u_i | k_i \in \mathbb{R} \forall i =1,\dots,m \right \}\)</span>.</p>
</div>
<p>Un dibujo que ayuda a visualizar el reflector elemental alrededor de <span class="math notranslate nohighlight">\(u^\perp\)</span> en el que se utiliza <span class="math notranslate nohighlight">\(u \in \mathbb{R}^m - \{0\}\)</span> , <span class="math notranslate nohighlight">\(||u||_2 = 1\)</span> y  <span class="math notranslate nohighlight">\(R=I_m-2 u u^T\)</span> es el siguiente :</p>
<img src="https://dl.dropboxusercontent.com/s/o3oht181nm8lfit/householder_drawing.png?dl=0" heigth="350" width="350">
<p>Las reflexiones de Householder pueden utilizarse para hacer ceros por debajo de una entrada de un vector.</p>
</div>
<div class="section" id="ejemplo-aplicando-reflectores-de-householder-a-un-vector">
<h3>Ejemplo aplicando reflectores de Householder a un vector<a class="headerlink" href="#ejemplo-aplicando-reflectores-de-householder-a-un-vector" title="Permalink to this headline">¶</a></h3>
<p>Considérese al vector <span class="math notranslate nohighlight">\(x=(1,2,3)^T\)</span>. Definir un reflector de Householder para hacer ceros por debajo de <span class="math notranslate nohighlight">\(x_1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1 2 3]
</pre></div>
</div>
</div>
</div>
<p>Utilizamos la definición <span class="math notranslate nohighlight">\(v=x-||x||_2e_1\)</span> con <span class="math notranslate nohighlight">\(e_1=(1,0,0)^T\)</span> vector canónico para construir al vector de Householder:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_1\)</span> pues se desea hacer ceros en las entradas debajo de la primera.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> 
<span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e1</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span> para <span class="math notranslate nohighlight">\(v\)</span> no unitario.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la reflexión de Householder, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(R\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(R x = x - \beta vv^Tx\)</span>.</strong></p>
</div>
<p>Hacemos ceros por debajo de la primera entrada de <span class="math notranslate nohighlight">\(x\)</span> haciendo la multiplicación matriz-vector <span class="math notranslate nohighlight">\(Rx\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[3.742 0.    0.   ]
</pre></div>
</div>
</div>
</div>
<p>El resultado de <span class="math notranslate nohighlight">\(Rx\)</span> es <span class="math notranslate nohighlight">\((||x||_2,0,0)^T\)</span> con <span class="math notranslate nohighlight">\(||x||_2\)</span> dada por:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>3.7416573867739413
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Observa que se preserva la norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana del vector, las matrices de reflexión de Householder son matrices ortogonales y por tanto isometrías: <span class="math notranslate nohighlight">\(||Rv||_2=||v||_2\)</span>.</p></li>
<li><p>Observa que a diferencia de las transformaciones de Gauss con las reflexiones de Householder en general se modifica la primera entrada, ver <a class="reference internal" href="#eg1"><span class="std std-ref">Ejemplo aplicando transformaciones de Gauss a un vector</span></a>.</p></li>
</ul>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(Rx\)</span> si se construye <span class="math notranslate nohighlight">\(R\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(R = I_3 - \beta v v^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.267  0.535  0.802]
 [ 0.535  0.61  -0.585]
 [ 0.802 -0.585  0.123]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="nd">@x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[3.742 0.    0.   ]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Ejemplo aplicando reflectores de Householder a un vector<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Considérese al mismo vector <span class="math notranslate nohighlight">\(x\)</span> del ejemplo anterior y el mismo objetivo “Definir un reflector de Householder para hacer ceros por debajo de <span class="math notranslate nohighlight">\(x_1\)</span>.”. Otra opción para construir al vector de Householder es <span class="math notranslate nohighlight">\(v=x+||x||_2e_1\)</span> con <span class="math notranslate nohighlight">\(e_1=(1,0,0)^T\)</span> vector canónico:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_1\)</span> pues se desea hacer ceros en las entradas debajo de la primera.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e1</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span> para <span class="math notranslate nohighlight">\(v\)</span> no unitario.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la reflexión de Householder, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(R\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(R x = x - \beta vv^Tx\)</span>.</strong></p>
</div>
<p>Hacemos ceros por debajo de la primera entrada de <span class="math notranslate nohighlight">\(x\)</span> haciendo la multiplicación matriz-vector <span class="math notranslate nohighlight">\(Rx\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-3.742 -0.    -0.   ]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Observa que difieren en signo las primeras entradas al utilizar  <span class="math notranslate nohighlight">\(v=x + ||x||_2 e_1\)</span> o  <span class="math notranslate nohighlight">\(v=x - ||x||_2 e_1\)</span>.</p>
</div>
</div>
<div class="section" id="cual-definicion-del-vector-de-householder-usar">
<h3>¿Cuál definición del vector de Householder usar?<a class="headerlink" href="#cual-definicion-del-vector-de-householder-usar" title="Permalink to this headline">¶</a></h3>
<p>En cualquiera de las dos definiciones del vector de Householder <span class="math notranslate nohighlight">\(v=x \pm ||x||_2 e_1\)</span>, la multiplicación <span class="math notranslate nohighlight">\(Rx\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> en el primer eje coordenado (pues se usa <span class="math notranslate nohighlight">\(e_1\)</span>):</p>
<img src="https://dl.dropboxusercontent.com/s/bfk7gojxm93ah5s/householder_2_posibilites.png?dl=0" heigth="400" width="400">
<p>El vector <span class="math notranslate nohighlight">\(v^+ = - u_0^+ = x-||x||_2e_1\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> respecto al subespacio <span class="math notranslate nohighlight">\(H^+\)</span> (que en el dibujo es una recta que cruza el origen). El vector <span class="math notranslate nohighlight">\(v^- = -u_0^- = x+||x||_2e_1\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> respecto al subespacio <span class="math notranslate nohighlight">\(H^-\)</span>.</p>
<p>Para reducir los errores por redondeo y evitar el problema de cancelación en la aritmética de punto flotante (ver <a class="reference external" href="https://itam-ds.github.io/analisis-numerico-computo-cientifico/I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">Sistema de punto flotante</a>) se utiliza:</p>
<div class="math notranslate nohighlight">
\[v = x+signo(x_1)||x||_2e_1\]</div>
<p>donde: <span class="math notranslate nohighlight">\(signo(x_1) = \begin{cases}
1 &amp;\text{ si } x_1 \geq 0 ,\\
-1 &amp;\text{ si } x_1 &lt; 0
\end{cases}.\)</span></p>
<p>La idea de la definción anterior con la función <span class="math notranslate nohighlight">\(signo(\cdot)\)</span> es que la reflexión (en el dibujo anterior <span class="math notranslate nohighlight">\(-||x||_2e_1\)</span> o <span class="math notranslate nohighlight">\(||x||_2e_1\)</span>) sea lo más alejada posible de <span class="math notranslate nohighlight">\(x\)</span>. En el dibujo anterior como <span class="math notranslate nohighlight">\(x_1, x_2&gt;0\)</span> entonces se refleja respecto al subespacio <span class="math notranslate nohighlight">\(H^-\)</span> quedando su reflexión igual a <span class="math notranslate nohighlight">\(-||x||_2e_1\)</span>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Otra forma de lidiar con el problema de cancelación es definiendo a la primera componente del vector de Householder <span class="math notranslate nohighlight">\(v_1\)</span> como <span class="math notranslate nohighlight">\(v_1=x_1-||x||_2\)</span> y haciendo una manipulación algebraica como sigue:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[v_1=x_1-||x||_2 = \frac{x_1^2-||x||_2^2}{x_1+||x||_2} = -\frac{x_2^2+x_3^2+\dots + x_m^2}{x_1+||x||_2}.\]</div>
<ul class="simple">
<li><p>En la implementación del cálculo del vector de Householder, es útil que <span class="math notranslate nohighlight">\(v_1=1\)</span> y así únicamente se almacenará <span class="math notranslate nohighlight">\(v[2:m]\)</span>. Al vector <span class="math notranslate nohighlight">\(v[2:m]\)</span> se le nombra <strong>parte esencial del vector de Householder</strong>.</p></li>
<li><p>Las transformaciones de reflexión de Householder se utilizan para la factorización QR. Ver <a class="reference external" href="https://en.wikipedia.org/wiki/QR_decomposition">QR decomposition</a>, la cual es una factorización estable numéricamente bajo el redondeo.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Reflejar al vector <span class="math notranslate nohighlight">\((1,1)^T\)</span> utilizando al vector <span class="math notranslate nohighlight">\((\frac{-4}{3}, \frac{2}{3})\)</span> para construir <span class="math notranslate nohighlight">\(R\)</span>.</p>
</div>
</div>
<div class="section" id="ejemplo-aplicando-reflectores-de-householder-a-una-matriz">
<h3>Ejemplo aplicando reflectores de Householder a una matriz<a class="headerlink" href="#ejemplo-aplicando-reflectores-de-householder-a-una-matriz" title="Permalink to this headline">¶</a></h3>
<p>Las reflexiones de Householder se utilizan para hacer ceros por debajo de la <strong>diagonal</strong> a una matriz y tener una forma triangular superior (mismo objetivo que las transformaciones de Gauss, ver <a class="reference internal" href="#eg2"><span class="std std-ref">Ejemplo aplicando transformaciones de Gauss a una matriz</span></a>). Por ejemplo si se han hecho ceros por debajo del elemento <span class="math notranslate nohighlight">\(a_{11}\)</span> y se quieren hacer ceros debajo de <span class="math notranslate nohighlight">\(a_{22}^{(1)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
R_2A^{(1)} = R_2
\left[
\begin{array}{cccc}
* &amp; * &amp; * &amp; *\\
0 &amp; * &amp; * &amp; *\\
0 &amp; * &amp; * &amp; * \\
0 &amp; * &amp; * &amp; * \\
0 &amp; * &amp; * &amp; *
\end{array}
\right]
=
\left[
\begin{array}{cccc}
* &amp; * &amp; * &amp; *\\
0 &amp; * &amp; * &amp; *\\
0 &amp; 0 &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; *
\end{array}
\right]
:= A^{(2)}
\end{array}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(a^{(1)}_{ij}\)</span> son las entradas de <span class="math notranslate nohighlight">\(A^{(1)} = R_1A^{(0)}\)</span> y <span class="math notranslate nohighlight">\(A^{(0)}=A\)</span>, <span class="math notranslate nohighlight">\(R_1\)</span> es matriz de reflexión de Householder.</p>
<p>En este caso</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_2 = 
\left [ 
\begin{array}{cc}
1 &amp; 0 \\
0 &amp; \hat{R_2}
\end{array}
\right ]
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(\hat{R}_2\)</span> una matriz de reflexión de Householder que hace ceros por debajo de de <span class="math notranslate nohighlight">\(a_{22}^{(1)}\)</span>. Se tienen las siguientes propiedades de <span class="math notranslate nohighlight">\(R_2\)</span>:</p>
<ul class="simple">
<li><p>No modifica el primer renglón de <span class="math notranslate nohighlight">\(A^{(1)}\)</span>.</p></li>
<li><p>No destruye los ceros de la primer columna de <span class="math notranslate nohighlight">\(A^{(1)}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(R_2\)</span> es una matriz de reflexión de Householder.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Para la implementación computacional <strong>no se inserta</strong> <span class="math notranslate nohighlight">\(\hat{R}_2\)</span> en <span class="math notranslate nohighlight">\(R_2\)</span>, en lugar de esto se aplica <span class="math notranslate nohighlight">\(\hat{R}_2\)</span> a la submatriz <span class="math notranslate nohighlight">\(A^{(1)}[2:m, 2:m]\)</span>.</p>
</div>
<p>Considérese a la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{4 \times 3}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A =
\left [
\begin{array}{ccc}
3 &amp; 2 &amp; -1 \\
2 &amp; 3 &amp; 2 \\
-1 &amp; 2 &amp; 3 \\
2 &amp; 1 &amp; 4
\end{array}
\right ] 
\end{split}\]</div>
<p>y aplíquense reflexiones de Householder para llevarla a una forma triangular superior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span> <span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">3</span> <span class="p">,</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 3.  2. -1.]
 [ 2.  3.  2.]
 [-1.  2.  3.]
 [ 2.  1.  4.]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_1\)</span> pues se desea hacer ceros en las entradas debajo de la primera entrada de la primera columna de <span class="math notranslate nohighlight">\(A\)</span>: <span class="math notranslate nohighlight">\(A[1:4,1]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(v= A[1:4,1] + signo(A[1,1])||A[1:4,1]||_2e_1\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">e1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 7.243  2.    -1.     2.   ]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span> para <span class="math notranslate nohighlight">\(v\)</span> no unitario.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0.032543690979272503
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la reflexión de Householder, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(R_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(R_1 A[1:4,1] = A[1:4,1] - \beta vv^TA[1:4,1]\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-4.243 -0.     0.    -0.   ]
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda <span class="math notranslate nohighlight">\(A^{(1)} = R_1 A^{(0)}\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:]</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-4.243 -2.828 -1.414]
 [-0.     1.667  1.886]
 [ 0.     2.667  3.057]
 [-0.    -0.333  3.886]]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Observa que a diferencia de las transformaciones de Gauss la reflexión de Householder <span class="math notranslate nohighlight">\(R_1\)</span> sí modifica el primer renglón de <span class="math notranslate nohighlight">\(A^{(0)}\)</span>, ver <a class="reference internal" href="#eg2-1"><span class="std std-ref">Después de hacer la multiplicación…</span></a>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana de <span class="math notranslate nohighlight">\(A[1:4,1]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>4.2426406871192865
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>4.242640687119285
</pre></div>
</div>
</div>
</div>
<p><strong>A continuación queremos hacer ceros debajo de la segunda entrada de la segunda columna de <span class="math notranslate nohighlight">\(A^{(1)}\)</span>.</strong></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Usamos <span class="math notranslate nohighlight">\(e_1\)</span> pues se desea hacer ceros en las entradas debajo de la segunda entrada de la segunda columna de <span class="math notranslate nohighlight">\(A^{(1)}\)</span>: <span class="math notranslate nohighlight">\(A^{(1)}[2:4,2]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(v= A[2:4,2] + signo(A[2,2])||A[2:4,2]||_2e_1\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">e1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 4.829  2.667 -0.333]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda la definición de <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span> para <span class="math notranslate nohighlight">\(v\)</span> no unitario.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Observa que por la definición de la reflexión de Householder, <strong>no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(R_2\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(R_2A[2:4,2] = A[2:4,2] - \beta vv^TA[2:4,2]\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-3.162  0.     0.   ]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda <span class="math notranslate nohighlight">\(A^{(2)} = R_2 A^{(1)}\)</span> pero sólo operamos en <span class="math notranslate nohighlight">\(A^{(2)}[2:4, 2:3]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A2_aux</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-3.162 -3.162]
 [ 0.     0.27 ]
 [ 0.     4.234]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana de <span class="math notranslate nohighlight">\(A[2:4,2]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>3.1622776601683795
</pre></div>
</div>
</div>
</div>
<p><strong>A continuación queremos hacer ceros debajo de la tercera entrada de la tercera columna de <span class="math notranslate nohighlight">\(A^{(2)}\)</span>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">e1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[4.512 4.234]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuerda <span class="math notranslate nohighlight">\(A^{(3)} = R_3 A^{(2)}\)</span> pero sólo operamos en <span class="math notranslate nohighlight">\(A^{(2)}[3:4, 3]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_aux</span> <span class="o">=</span> <span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-4.243  0.   ]
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>4.242640687119285
</pre></div>
</div>
</div>
</div>
<p>Entonces sólo falta colocar los renglones y columnas para tener a la matriz <span class="math notranslate nohighlight">\(A^{(3)}\)</span>. Para esto combinamos columnas y renglones en <em>numpy</em> con <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html">column_stack</a> y <em>row_stack</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_zeros</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_aux_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_zeros</span><span class="p">),</span> <span class="n">A3_aux</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_aux_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.    -4.243]
 [ 0.     0.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_aux_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A2_aux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:],</span> <span class="n">A3_aux_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_aux_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-3.162 -3.162]
 [ 0.    -4.243]
 [ 0.     0.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_zeros</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_aux_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_zeros</span><span class="p">),</span> <span class="n">A3_aux_3</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_aux_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.    -3.162 -3.162]
 [ 0.     0.    -4.243]
 [ 0.     0.     0.   ]]
</pre></div>
</div>
</div>
</div>
<p>La matriz <span class="math notranslate nohighlight">\(A^{(3)} = R_3 R_2 R_1 A^{(0)}\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:],</span> <span class="n">A3_aux_4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[-4.243 -2.828 -1.414]
 [ 0.    -3.162 -3.162]
 [ 0.     0.    -4.243]
 [ 0.     0.     0.   ]]
</pre></div>
</div>
</div>
</div>
<p>Podemos verificar lo anterior comparando con la matriz <span class="math notranslate nohighlight">\(R\)</span> de la factorización <span class="math notranslate nohighlight">\(QR\)</span> de <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Q:
[[-0.707  0.     0.471]
 [-0.471 -0.527  0.079]
 [ 0.236 -0.843 -0.157]
 [-0.471  0.105 -0.864]]
R:
[[-4.243 -2.828 -1.414]
 [ 0.    -3.162 -3.162]
 [ 0.     0.    -4.243]]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Aplicar reflexiones de Householder a la matriz</p>
<div class="math notranslate nohighlight">
\[\begin{split}A =
\left [
\begin{array}{cccc}
4 &amp; 1 &amp; -2 &amp; 2 \\
1 &amp; 2 &amp; 0 &amp; 1\\
-2 &amp; 0 &amp; 3 &amp; -2 \\
2 &amp; 1 &amp; -2 &amp; -1
\end{array}
\right ] 
\end{split}\]</div>
<p>para obtener una matriz triangular superior.</p>
</div>
</div>
</div>
<div class="section" id="transformaciones-de-rotacion">
<span id="trot"></span><h2>Transformaciones de rotación<a class="headerlink" href="#transformaciones-de-rotacion" title="Permalink to this headline">¶</a></h2>
<p>En esta sección suponemos que <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <span class="math notranslate nohighlight">\(A\)</span> es una matriz con entradas <span class="math notranslate nohighlight">\(a_{ij} \in \mathbb{R}^{m \times n} \forall i=1,2,\dots,m, j=1, 2, \dots, n\)</span>.</p>
<p>Si <span class="math notranslate nohighlight">\(u, v \in \mathbb{R}^2-\{0\}\)</span> con <span class="math notranslate nohighlight">\(\ell = ||u||_2 = ||v||_2\)</span> y se desea rotar al vector <span class="math notranslate nohighlight">\(u\)</span> en sentido contrario a las manecillas del reloj por un ángulo <span class="math notranslate nohighlight">\(\theta\)</span> para llevarlo a la dirección de <span class="math notranslate nohighlight">\(v\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/vq8eu0yga2x7cb2/rotation_1.png?dl=0" heigth="500" width="500">
<p>A partir de las relaciones anteriores como <span class="math notranslate nohighlight">\(cos(\phi)=\frac{u_1}{\ell}, sen(\phi)=\frac{u_2}{\ell}\)</span> se tiene: <span class="math notranslate nohighlight">\(v_1 = (cos\theta)u_1-(sen\theta)u_2\)</span>, <span class="math notranslate nohighlight">\(v_2=(sen\theta)u_1+(cos\theta)u_2\)</span> equivalentemente:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]
=
\left[ \begin{array}{cc}
cos\theta &amp; -sen\theta\\
sen\theta &amp; cos\theta
\end{array}
\right] \cdot 
\left[\begin{array}{c}
u_1\\
u_2
\end{array}
\right]
\end{array}
\end{split}\]</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>La matriz <span class="math notranslate nohighlight">\(R_O\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_O=
\left[ \begin{array}{cc}
cos\theta &amp; -sen\theta\\
sen\theta &amp; cos\theta
\end{array}
\right] 
\end{split}\]</div>
<p>se nombra matriz de <strong>rotación</strong> o <strong>rotaciones Givens</strong>, es una matriz ortogonal pues <span class="math notranslate nohighlight">\(R_O^TR_O=I_2\)</span>.</p>
<p>La multiplicación <span class="math notranslate nohighlight">\(v=R_Ou\)</span> es una rotación en sentido contrario a las manecillas del reloj, de hecho cumple <span class="math notranslate nohighlight">\(det(R_O)=1\)</span>. La multiplicación <span class="math notranslate nohighlight">\(u=R_O^Tv\)</span> es una rotación en sentido de las manecillas del reloj y el ángulo asociado es <span class="math notranslate nohighlight">\(-\theta\)</span>.</p>
</div>
<div class="section" id="ejemplo-aplicando-rotaciones-givens-a-un-vector">
<h3>Ejemplo aplicando rotaciones Givens a un vector<a class="headerlink" href="#ejemplo-aplicando-rotaciones-givens-a-un-vector" title="Permalink to this headline">¶</a></h3>
<p>Rotar al vector <span class="math notranslate nohighlight">\(v=(1,1)^T\)</span> un ángulo de <span class="math notranslate nohighlight">\(45^o\)</span> en <strong>sentido contrario a las manecillas del reloj</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>La matriz <span class="math notranslate nohighlight">\(R_O\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_O = \left[ \begin{array}{cc}
cos(\frac{\pi}{4}) &amp; -sen(\frac{\pi}{4})\\
sen(\frac{\pi}{4}) &amp; cos(\frac{\pi}{4})
\end{array}
\right ]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
<span class="n">RO</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>
              <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">RO</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.707 -0.707]
 [ 0.707  0.707]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">RO</span><span class="nd">@v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[0.    1.414]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Con esta operación estamos aplicando rotación al vector “v”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1.4142135623730951
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Vemos que la norma es la misma después de la rotación.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Observa que se preserva la norma <span class="math notranslate nohighlight">\(2\)</span> o Euclidiana del vector, las matrices de rotación Givens son matrices ortogonales y por tanto isometrías: <span class="math notranslate nohighlight">\(||R_0v||_2=||v||_2\)</span>.</p>
</div>
<ul class="simple">
<li><p>Un objetivo que buscamos satisfacer es hacer cero alguna entrada.</p></li>
</ul>
<p>En el ejemplo anterior se hizo cero la entrada <span class="math notranslate nohighlight">\(v_1\)</span> de <span class="math notranslate nohighlight">\(v\)</span>. Las matrices de rotación se utilizan para hacer ceros en entradas de un vector. Por ejemplo si <span class="math notranslate nohighlight">\(v=(v_1,v_2)^T\)</span> y <strong>se desea hacer cero la entrada <span class="math notranslate nohighlight">\(v_2\)</span> de <span class="math notranslate nohighlight">\(v\)</span></strong> se puede utilizar la matriz de rotación:</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_O = \left[ \begin{array}{cc}
\frac{v_1}{\sqrt{v_1^2+v_2^2}} &amp; \frac{v_2}{\sqrt{v_1^2+v_2^2}}\\
-\frac{v_2}{\sqrt{v_1^2+v_2^2}} &amp; \frac{v_1}{\sqrt{v_1^2+v_2^2}}
\end{array}
\right ]
\end{split}\]</div>
<p>pues:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
 \left[ \begin{array}{cc}
\frac{v_1}{\sqrt{v_1^2+v_2^2}} &amp; \frac{v_2}{\sqrt{v_1^2+v_2^2}}\\
-\frac{v_2}{\sqrt{v_1^2+v_2^2}} &amp; \frac{v_1}{\sqrt{v_1^2+v_2^2}}
\end{array}
\right ] \cdot 
\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]=
\left[ \begin{array}{c}
\frac{v_1^2+v_2^2}{\sqrt{v_1^2+v_2^2}}\\
\frac{-v_1v_2+v_1v_2}{\sqrt{v_1^2+v_2^2}}
\end{array}
\right ]
=
\left[ \begin{array}{c}
\frac{v_1^2+v_2^2}{\sqrt{v_1^2+v_2^2}}\\
0
\end{array}
\right ]=
\left[ \begin{array}{c}
||v||_2\\
0
\end{array}
\right ]
\end{array}
\end{split}\]</div>
<p>Y definiendo <span class="math notranslate nohighlight">\(cos(\theta)=\frac{v_1}{\sqrt{v_1^2+v_2^2}}, sen(\theta)=\frac{v_2}{\sqrt{v_1^2+v_2^2}}\)</span> se tiene :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_O=\left[ \begin{array}{cc}
cos\theta &amp; sen\theta\\
-sen\theta &amp; cos\theta
\end{array}
\right]
\end{split}\]</div>
<p>que en el ejemplo anterior como <span class="math notranslate nohighlight">\(v=(1,1)^T\)</span> entonces: <span class="math notranslate nohighlight">\(cos(\theta)=\frac{1}{\sqrt{2}}, sen(\theta)=\frac{1}{\sqrt{2}}\)</span> por lo que <span class="math notranslate nohighlight">\(\theta=\frac{\pi}{4}\)</span> y:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_O=\left[ \begin{array}{cc}
\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}}\\
-\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}}
\end{array}
\right]
\end{split}\]</div>
<p>que es una matriz de rotación para un ángulo que gira <strong>en sentido de las manecillas del reloj</strong>.</p>
<p>Para <strong>hacer cero la entrada <span class="math notranslate nohighlight">\(v_1\)</span> de <span class="math notranslate nohighlight">\(v\)</span></strong> hay que usar:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
R_O=\left[ \begin{array}{cc}
cos\theta &amp; -sen\theta\\
sen\theta &amp; cos\theta
\end{array}
\right]
=\left[ \begin{array}{cc}
\frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{2}}\\
\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}}
\end{array}
\right]
\end{array}
\end{split}\]</div>
<p>que es una matriz de rotación para un ángulo que gira <strong>en sentido contrario de las manecillas del reloj</strong>.</p>
<ul class="simple">
<li><p>El <span class="math notranslate nohighlight">\(R_0\)</span> de este ejercicio es la fórmula general para hacer cero alguna entrada de una matriz de 2x2.</p></li>
<li><p>Todas las matriz de rotación son ortogonales porque preservan su norma. Pero no todas las ortogonales son de rotación.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Usar una matriz de rotación Givens para rotar al vector <span class="math notranslate nohighlight">\((-3, 4)^T\)</span> un ángulo de <span class="math notranslate nohighlight">\(\frac{\pi}{3}\)</span> en sentido de las manecillas del reloj.</p>
</div>
</div>
<div class="section" id="ejemplo-aplicando-rotaciones-givens-a-una-matriz">
<h3>Ejemplo aplicando rotaciones Givens a una matriz<a class="headerlink" href="#ejemplo-aplicando-rotaciones-givens-a-una-matriz" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Con esto lidiamos con rotación de matrices de más de 2 dimensiones.</p></li>
</ul>
<p>Las rotaciones Givens permiten hacer ceros en entradas de una matriz que son <strong>seleccionadas</strong>. Por ejemplo si se desea hacer cero la entrada <span class="math notranslate nohighlight">\(x_4\)</span> de <span class="math notranslate nohighlight">\(x \in \mathbb{R}^4\)</span>, se definen <span class="math notranslate nohighlight">\(cos\theta = \frac{x_2}{\sqrt{x_2^2 + x_4^2}}, sen\theta = \frac{x_4}{\sqrt{x_2^2 + x_4^2}}\)</span> y</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{24}^\theta=
\left [ 
\begin{array}{cccc}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; cos\theta &amp; 0 &amp; sen\theta \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; -sen\theta &amp; 0 &amp; cos\theta
\end{array}
\right ]
\end{split}\]</div>
<p>entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{24}^\theta x =
\begin{array}{l}
\left [
\begin{array}{cccc}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; cos\theta &amp; 0 &amp; sen\theta \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; -sen\theta &amp; 0 &amp; cos\theta
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4
\end{array}
\right ]
=
\left [
\begin{array}{c}
x_1 \\
\sqrt{x_2^2 + x_4^2} \\
x_3 \\
0
\end{array}
\right ]
\end{array}
\end{split}\]</div>
<p>Y se escribe que se hizo una rotación en el plano <span class="math notranslate nohighlight">\((2,4)\)</span>.</p>
<ul class="simple">
<li><p>Los ceros que habíamos asignado hacen que el vector de <span class="math notranslate nohighlight">\(x\)</span> no se afecte en algunos casos.</p></li>
<li><p>Podemos extrapolar esa misma idea a matrices más grandes.</p>
<ul>
<li><p>Debes elegir unicamente la estructura correcta de tu matriz de rotación.</p></li>
</ul>
</li>
<li><p>Si estuvieras trabajando con una matriz de 2x2 entonces los cosenos de los valores se efectarían.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que sólo se modificaron dos entradas de <span class="math notranslate nohighlight">\(x\)</span>: <span class="math notranslate nohighlight">\(x_2, x_4\)</span> por lo que el mismo efecto se obtiene al hacer la multiplicación:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\left[ \begin{array}{cc}
cos\theta &amp; -sen\theta\\
sen\theta &amp; cos\theta
\end{array}
\right]
\left [ 
\begin{array}{c}
x_2\\
x_4
\end{array}
\right ]
\end{array}
\end{split}\]</div>
<p>para tales entradas.</p>
</div>
<ul class="simple">
<li><p>En este ejercicio elegimos el plano 1,2.</p>
<ul>
<li><p>Modificamos primer columna y segundo renglón.</p></li>
<li><p>Lo hacemos con los “senos” y “cosenos” correspondientes.</p></li>
</ul>
</li>
</ul>
<p>Considérese a la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{4 \times 4}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A =
\left [
\begin{array}{cccc}
4 &amp; 1 &amp; -2 &amp; 2 \\
1 &amp; 2 &amp; 0 &amp; 1\\
-2 &amp; 0 &amp; 3 &amp; -2 \\
2 &amp; 1 &amp; -2 &amp; -1
\end{array}
\right ] 
\end{split}\]</div>
<p>y aplíquense rotaciones Givens para hacer ceros en las entradas debajo de la diagonal de <span class="math notranslate nohighlight">\(A\)</span> y tener una matriz <strong>triangular superior</strong>.</p>
<p><strong>Entrada <span class="math notranslate nohighlight">\(a_{21}\)</span>, plano <span class="math notranslate nohighlight">\((1,2)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idx_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">idx_2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idx_column</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.  1. -2.  2.]
 [ 1.  2.  0.  1.]
 [-2.  0.  3. -2.]
 [ 2.  1. -2. -1.]]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Vamos a usar la fórmula general que ya habíamos visto arriba:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_11</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span><span class="n">idx_column</span><span class="p">]</span>
<span class="n">a_21</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span><span class="n">idx_column</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_11</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_21</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cos_theta</span> <span class="o">=</span> <span class="n">a_11</span><span class="o">/</span><span class="n">norm</span>
<span class="n">sen_theta</span> <span class="o">=</span> <span class="n">a_21</span><span class="o">/</span><span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">sen_theta</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="n">sen_theta</span><span class="p">,</span> <span class="n">cos_theta</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.97   0.243]
 [-0.243  0.97 ]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Extraemos sólo los renglones a los que se les aplicará la matriz de rotación.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_subset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,:],</span> <span class="n">A</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.  1. -2.  2.]
 [ 1.  2.  0.  1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R12</span><span class="nd">@A_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.123  1.455 -1.94   2.183]
 [ 0.     1.698  0.485  0.485]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A1_aux</span> <span class="o">=</span> <span class="n">R12</span><span class="nd">@A_subset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.123  1.455 -1.94   2.183]
 [ 0.     1.698  0.485  0.485]]
</pre></div>
</div>
</div>
</div>
<p>Hacemos copia para un fácil manejo de los índices y matrices modificadas. Podríamos también usar <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.view.html">numpy.view</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A1_aux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">A1</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A1_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(A^{(1)} = R_{12}^\theta A^{(0)}\)</span>.</p>
</div>
<ul class="simple">
<li><p>Aquí ya colocamos el subresultado que obtuvimos a la matriz original.</p></li>
<li><p>Solo modificamos el primero y segundo renglón.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.123  1.455 -1.94   2.183]
 [ 0.     1.698  0.485  0.485]
 [-2.     0.     3.    -2.   ]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.  1. -2.  2.]
 [ 1.  2.  0.  1.]
 [-2.  0.  3. -2.]
 [ 2.  1. -2. -1.]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma 2 o Euclidiana de <span class="math notranslate nohighlight">\(A[1:4,1]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A1</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p><strong>Entrada <span class="math notranslate nohighlight">\(a_{31}\)</span>, plano <span class="math notranslate nohighlight">\((1,3)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idx_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">idx_2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">idx_column</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_11</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">a_31</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_11</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_31</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cos_theta</span> <span class="o">=</span> <span class="n">a_11</span><span class="o">/</span><span class="n">norm</span>
<span class="n">sen_theta</span> <span class="o">=</span> <span class="n">a_31</span><span class="o">/</span><span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R13</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">sen_theta</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="n">sen_theta</span><span class="p">,</span> <span class="n">cos_theta</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R13</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.9   -0.436]
 [ 0.436  0.9  ]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Extraemos sólo los renglones a los que se les aplicará la matriz de rotación.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A1_subset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A1</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,:],</span> <span class="n">A1</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.123  1.455 -1.94   2.183]
 [-2.     0.     3.    -2.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R13</span><span class="nd">@A1_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 0.     0.635  1.852 -0.847]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A2_aux</span> <span class="o">=</span> <span class="n">R13</span><span class="nd">@A1_subset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 0.     0.635  1.852 -0.847]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A2</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A2</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A2_aux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">A2</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A2_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(A^{(2)} = R_{13}^\theta A^{(1)}\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.123  1.455 -1.94   2.183]
 [ 0.     1.698  0.485  0.485]
 [-2.     0.     3.    -2.   ]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.  1. -2.  2.]
 [ 1.  2.  0.  1.]
 [-2.  0.  3. -2.]
 [ 2.  1. -2. -1.]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma 2 o Euclidiana de <span class="math notranslate nohighlight">\(A[1:4,1]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A2</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p><strong>Entrada <span class="math notranslate nohighlight">\(a_{41}\)</span>, plano <span class="math notranslate nohighlight">\((1,4)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idx_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">idx_2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">idx_column</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_11</span> <span class="o">=</span> <span class="n">A2</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">a_41</span> <span class="o">=</span> <span class="n">A2</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_11</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_41</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cos_theta</span> <span class="o">=</span> <span class="n">a_11</span><span class="o">/</span><span class="n">norm</span>
<span class="n">sen_theta</span> <span class="o">=</span> <span class="n">a_41</span><span class="o">/</span><span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R14</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">sen_theta</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="n">sen_theta</span><span class="p">,</span> <span class="n">cos_theta</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.917  0.4  ]
 [-0.4    0.917]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Extraemos sólo los renglones a los que se les aplicará la matriz de rotación.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A2_subset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A2</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,:],</span> <span class="n">A2</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R14</span><span class="nd">@A2_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.     1.6   -3.6    2.2  ]
 [ 0.     0.393 -0.611 -2.051]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_aux</span> <span class="o">=</span> <span class="n">R14</span><span class="nd">@A2_subset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.     1.6   -3.6    2.2  ]
 [ 0.     0.393 -0.611 -2.051]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A3_aux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">A3</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A3_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(A^{(3)} = R_{14}^\theta A^{(2)}\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.     1.6   -3.6    2.2  ]
 [ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]
 [ 0.     0.393 -0.611 -2.051]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Vemos que el resultado de este ejercicio es el cero del tercer renglón.</p></li>
</ul>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma 2 o Euclidiana de <span class="math notranslate nohighlight">\(A[1:4,1]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A3</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p><strong>Entrada <span class="math notranslate nohighlight">\(a_{32}\)</span>, plano <span class="math notranslate nohighlight">\((2,3)\)</span>:</strong></p>
<ul class="simple">
<li><p>En este caso vamos a hacer 0 un valor de la segunda columna.</p></li>
<li><p>Vamos a ir afectando todo el renglón parejo.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idx_1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idx_2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">idx_column</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_22</span> <span class="o">=</span> <span class="n">A2</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">a_32</span> <span class="o">=</span> <span class="n">A2</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_22</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a_32</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cos_theta</span> <span class="o">=</span> <span class="n">a_22</span><span class="o">/</span><span class="n">norm</span>
<span class="n">sen_theta</span> <span class="o">=</span> <span class="n">a_32</span><span class="o">/</span><span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R23</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">sen_theta</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="n">sen_theta</span><span class="p">,</span> <span class="n">cos_theta</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R23</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.937  0.35 ]
 [-0.35   0.937]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Extraemos sólo los renglones a los que se les aplicará la matriz de rotación.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A3_subset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A3</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,:],</span> <span class="n">A3</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R23</span><span class="nd">@A3_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.     1.813  1.103  0.158]
 [ 0.     0.     1.565 -0.963]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A4_aux</span> <span class="o">=</span> <span class="n">R23</span><span class="nd">@A3_subset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A4_aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.     1.813  1.103  0.158]
 [ 0.     0.     1.565 -0.963]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A4</span> <span class="o">=</span> <span class="n">A3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A4</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A4_aux</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">A4</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">A4_aux</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(A^{(4)} = R_{23}^\theta A^{(3)}\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.     1.6   -3.6    2.2  ]
 [ 0.     1.813  1.103  0.158]
 [ 0.     0.     1.565 -0.963]
 [ 0.     0.393 -0.611 -2.051]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.     1.6   -3.6    2.2  ]
 [ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]
 [ 0.     0.393 -0.611 -2.051]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.583  1.309 -3.055  2.837]
 [ 0.     1.698  0.485  0.485]
 [ 0.     0.635  1.852 -0.847]
 [ 2.     1.    -2.    -1.   ]]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se preserva la norma 2 o Euclidiana de <span class="math notranslate nohighlight">\(A[1:4,2]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A4</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2.449489742783178
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">idx_column</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2.449489742783178
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Finalizar el ejercicio para llevar a la matriz <span class="math notranslate nohighlight">\(A\)</span> a una matriz triangular superior.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Preguntas de comprehensión.</strong></p>
<p>1)Escribe ejemplos de operaciones vectoriales y matriciales básicas del Álgebra Lineal Numérica.</p>
<p>2)¿Para qué se utilizan las transformaciones de Gauss?</p>
<p>3)Escribe nombres de factorizaciones en las que se utilizan las transformaciones de Gauss.</p>
<p>4)Escribe propiedades que tiene una matriz ortogonal.</p>
<p>5)¿Una matriz ortogonal es rectangular?</p>
<p>6)¿Qué propiedades tienen las matrices de proyección, reflexión y rotación?</p>
<p>7)¿Qué problema numérico se quiere resolver al definir un vector de Householder como <span class="math notranslate nohighlight">\(x+signo(x_1)||x||_2e_1\)</span>?</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>G. H. Golub, C. F. Van Loan, Matrix Computations, John Hopkins University Press, 2013.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./II.computo_matricial/2.1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../../I.computo_cientifico/1.7/Integracion_numerica.html" title="previous page">1.7 Integración Numérica</a>
    <a class='right-next' id="next-link" href="../2.2/Eigenvalores_y_eigenvectores.html" title="next page">2.2 Eigenvalores y eigenvectores</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>