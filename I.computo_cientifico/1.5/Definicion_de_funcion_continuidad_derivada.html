

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1.5 Definición de función, continuidad y derivada</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6 Polinomios de Taylor y diferenciación numérica" href="../1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html" />
    <link rel="prev" title="1.4 Condición de un problema y estabilidad de un algoritmo" href="../1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas.html">
   3.2 Algoritmos de descenso y búsqueda de línea para funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ecuaciones_no_lineales.html">
   3.3 Ecuaciones no lineales
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion">
   Función
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notacion">
     Notación
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conjunto-abierto-cerrado-cerradura-e-interior">
     Conjunto abierto, cerrado, cerradura e interior
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuidad">
   Continuidad
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Notación
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-diferenciable">
   Función Diferenciable
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-f-mathbb-r-rightarrow-mathbb-r">
     Caso
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R} \rightarrow \mathbb{R}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Notación
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-f-mathbb-r-n-rightarrow-mathbb-r-m">
     Caso
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Notación
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Ejemplo
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regla-de-la-cadena">
   Regla de la cadena
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ej1">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-particular">
     Caso particular
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejrestriccionalinea">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ej2">
     Ejemplo
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
   Segunda derivada de una función
   <span class="math notranslate nohighlight">
    \(f: \mathbb{R}^n \rightarrow \mathbb{R}\)
   </span>
   .
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regla-de-la-cadena-para-la-segunda-derivada">
   Regla de la cadena para la segunda derivada
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cp2">
     Caso particular
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cp3">
     Caso particular
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     Ejemplo
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tablita-util-para-formulas-de-diferenciacion-con-el-operador-nabla">
   Tablita útil para fórmulas de diferenciación con el operador
   <span class="math notranslate nohighlight">
    \(\nabla\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comentario-respecto-al-computo-simbolico-o-algebraico-y-numerico">
   Comentario respecto al cómputo simbólico o algebraico y númerico
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="definicion-de-funcion-continuidad-y-derivada">
<span id="fcd"></span><h1>1.5 Definición de función, continuidad y derivada<a class="headerlink" href="#definicion-de-funcion-continuidad-y-derivada" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de la <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/mmd1uzvwhdwsyiu/4.3.2.Teoria_de_convexidad_Funciones_convexas.pdf?dl=0">liga2</a> e inicio de <a class="reference external" href="https://www.dropbox.com/s/ko86cce1olbtsbk/4.3.1.Teoria_de_convexidad_Conjuntos_convexos.pdf?dl=0">liga3</a>.</p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Aprenderá las definiciones de función y derivada de una función en algunos casos de interés para el curso. En específico el caso de derivada direccional es muy importante.</p></li>
<li><p>Aprenderá que el gradiente y Hessiana de una función son un vector y una matriz de primeras (información de primer orden) y segundas derivadas (información de segundo orden) respectivamente.</p></li>
<li><p>Aprenderá algunas fórmulas utilizadas con el operador nabla de diferenciación.</p></li>
<li><p>Aprenderá la diferencia entre el cálculo algebraico o simbólico y el numérico vía el paquete <em>SymPy</em>.</p></li>
</ul>
</div>
<div class="section" id="funcion">
<h2>Función<a class="headerlink" href="#funcion" title="Permalink to this headline">¶</a></h2>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Una función, <span class="math notranslate nohighlight">\(f\)</span>, es una regla de correspondencia entre un conjunto nombrado dominio y otro conjunto nombrado codominio.</p>
</div>
<div class="section" id="notacion">
<h3>Notación<a class="headerlink" href="#notacion" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f: A \rightarrow B\)</span> es una función de un conjunto <span class="math notranslate nohighlight">\(\text{dom}f \subseteq A\)</span> en un conjunto <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p><span class="math notranslate nohighlight">\(\text{dom}f\)</span> (el dominio de <span class="math notranslate nohighlight">\(f\)</span>) puede ser un subconjunto propio de <span class="math notranslate nohighlight">\(A\)</span>, esto es, algunos elementos de <span class="math notranslate nohighlight">\(A\)</span> y otros no, son mapeados a elementos de <span class="math notranslate nohighlight">\(B\)</span>.</p>
</div>
<p>En lo que sigue se considera al espacio <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y se asume que conjuntos y subconjuntos están en este espacio.</p>
</div>
<div class="section" id="conjunto-abierto-cerrado-cerradura-e-interior">
<span id="cacci"></span><h3>Conjunto abierto, cerrado, cerradura e interior<a class="headerlink" href="#conjunto-abierto-cerrado-cerradura-e-interior" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Un punto <span class="math notranslate nohighlight">\(x\)</span> se nombra <strong>punto límite</strong> de un conjunto <span class="math notranslate nohighlight">\(X\)</span>, si existe una sucesión <span class="math notranslate nohighlight">\(\{x_k\} \subset X\)</span> que converge a <span class="math notranslate nohighlight">\(x\)</span>. El conjunto de puntos límites se nombra <strong>cerradura</strong> o <em>closure</em> de <span class="math notranslate nohighlight">\(X\)</span> y se denota como <span class="math notranslate nohighlight">\(\text{cl}X\)</span>.</p>
<p>Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se nombra <strong>cerrado</strong> si es igual a su cerradura.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>El interior de un conjunto <span class="math notranslate nohighlight">\(X\)</span> es el conjunto de <strong>puntos interiores</strong>: un punto <span class="math notranslate nohighlight">\(x\)</span> de un conjunto <span class="math notranslate nohighlight">\(X\)</span> se llama interior si existe una <strong>vecindad</strong> de <span class="math notranslate nohighlight">\(x\)</span> (conjunto abierto* que contiene a <span class="math notranslate nohighlight">\(x\)</span>) contenida en <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>*Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se dice que es <strong>abierto</strong> si <span class="math notranslate nohighlight">\(\forall x \in X\)</span> existe una bola abierta* centrada en <span class="math notranslate nohighlight">\(x\)</span> y contenida en <span class="math notranslate nohighlight">\(X\)</span>. Es equivalente escribir que <span class="math notranslate nohighlight">\(X\)</span> es <strong>abierto</strong> si su complemento <span class="math notranslate nohighlight">\(\mathbb{R}^n \ X\)</span> es cerrado.</p>
<p>*Una <strong>bola abierta</strong> con radio <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span> y centrada en <span class="math notranslate nohighlight">\(x\)</span> es el conjunto: <span class="math notranslate nohighlight">\(B_\epsilon(x) =\{y \in \mathbb{R}^n : ||y-x|| &lt; \epsilon\}\)</span>. Ver <a class="reference internal" href="../1.3/Normas_vectoriales_y_matriciales.html#egnp"><span class="std std-ref">Ejemplos de gráficas de normas en el plano</span></a> para ejemplos de bolas abiertas en el plano.</p>
</div>
<p>En lo siguiente <span class="math notranslate nohighlight">\(\text{intdom}f\)</span> es el <strong>interior</strong> del dominio de <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
</div>
<div class="section" id="continuidad">
<h2>Continuidad<a class="headerlink" href="#continuidad" title="Permalink to this headline">¶</a></h2>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p><span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> si <span class="math notranslate nohighlight">\(\forall \epsilon &gt;0 \exists \delta &gt; 0\)</span> tal que:</p>
<div class="math notranslate nohighlight">
\[y \in \text{dom}f, ||y-x||_2 \leq \delta \implies ||f(y)-f(x)||_2 \leq \epsilon\]</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> continua en un punto <span class="math notranslate nohighlight">\(x\)</span> del dominio de <span class="math notranslate nohighlight">\(f\)</span> entonces <span class="math notranslate nohighlight">\(f(y)\)</span> es arbitrariamente cercana a <span class="math notranslate nohighlight">\(f(x)\)</span> para <span class="math notranslate nohighlight">\(y\)</span> en el dominio de <span class="math notranslate nohighlight">\(f\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Otra forma de definir que <span class="math notranslate nohighlight">\(f\)</span> sea continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> es con sucesiones y límites: si <span class="math notranslate nohighlight">\(\{x_i\}_{i \in \mathbb{N}} \subseteq \text{dom}f\)</span> es una sucesión de puntos en el dominio de <span class="math notranslate nohighlight">\(f\)</span> que converge a <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span>, <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}x_i = x\)</span>, y <span class="math notranslate nohighlight">\(f\)</span> es continua en <span class="math notranslate nohighlight">\(x\)</span> entonces la sucesión <span class="math notranslate nohighlight">\(\{f(x_i)\}_{i \in \mathbb{N}}\)</span> converge a <span class="math notranslate nohighlight">\(f(x)\)</span>: <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}f(x_i) = f(x) = f \left(\displaystyle \lim_{i \rightarrow \infty} x_i \right )\)</span>.</p></li>
</ul>
</div>
<div class="section" id="id1">
<h3>Notación<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(\mathcal{C}([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ continuas en el intervalo [a,b]}\}\)</span> y <span class="math notranslate nohighlight">\(\mathcal{C}(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ continuas en su dominio}\}\)</span>.</p>
</div>
</div>
<div class="section" id="funcion-diferenciable">
<h2>Función Diferenciable<a class="headerlink" href="#funcion-diferenciable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="caso-f-mathbb-r-rightarrow-mathbb-r">
<h3>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#caso-f-mathbb-r-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0 \in (a,b)\)</span> si <span class="math notranslate nohighlight">\(\displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}\)</span> existe y escribimos:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x_0) = \displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}.\]</div>
</div>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\([a,b]\)</span> si es diferenciable en cada punto de <span class="math notranslate nohighlight">\([a,b]\)</span>. Análogamente definiendo la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span> se tiene:</p>
<p><span class="math notranslate nohighlight">\(f^{(1)}(x_0) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x_0+h)-f(x_0)}{h}\)</span> que típicamente se escribe como:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x+h)-f(x)}{h}.\]</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si <span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0\)</span> entonces <span class="math notranslate nohighlight">\(f(x) \approx f(x_0) + f^{(1)}(x_0)(x-x_0)\)</span>. Gráficamente:</p>
<img src="https://dl.dropboxusercontent.com/s/3t13ku6pk1pjwxo/f_diferenciable.png?dl=0" heigth="500" width="500">
</div>
<p>Como las derivadas también son funciones tenemos una notación para las derivadas que son continuas:</p>
</div>
<div class="section" id="id2">
<h3>Notación<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(\mathcal{C}^n([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ con } n \text{ derivadas continuas en el intervalo [a,b]}\}\)</span>.</p>
<p>En Python podemos utilizar el paquete <a class="reference external" href="https://www.sympy.org/en/index.html">SymPy</a> para calcular límites y derivadas de forma <strong>simbólica</strong> (ver <a class="reference external" href="https://docs.sympy.org/latest/tutorial/calculus.html">sympy/calculus</a>) que es diferente al cálculo <strong>numérico</strong> que se revisa en <a class="reference internal" href="../1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html#ptdn"><span class="std std-ref">Polinomios de Taylor y diferenciación numérica</span></a>.</p>
</div>
<div class="section" id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Límite de <span class="math notranslate nohighlight">\(\frac{\cos(x+h) - \cos(x)}{h}\)</span> para <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, h&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">quotient</span> <span class="o">=</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-sin(x)
</pre></div>
</div>
</div>
</div>
<p>Lo anterior corresponde a la <strong>derivada de <span class="math notranslate nohighlight">\(\cos(x)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-sin(x)
</pre></div>
</div>
</div>
</div>
<p><strong>Si queremos evaluar la derivada podemos usar:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-1
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Hay que notar que estamos usando la constante pi del paquete <em>sympy</em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>d         
──(cos(x))
dx        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">doit_numerically</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-1.00000000000000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="caso-f-mathbb-r-n-rightarrow-mathbb-r-m">
<h3>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span><a class="headerlink" href="#caso-f-mathbb-r-n-rightarrow-mathbb-r-m" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> si existe una matriz <span class="math notranslate nohighlight">\(Df(x) \in \mathbb{R}^{m\times n}\)</span> tal que:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{||f(z)-f(x)-Df(x)(z-x)||_2}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<p>en este caso <span class="math notranslate nohighlight">\(Df(x)\)</span> se llama la derivada de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Sólo puede existir a lo más una matriz que satisfaga el límite anterior.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> también es llamada la <strong>Jacobiana</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Se dice que <span class="math notranslate nohighlight">\(f\)</span> es diferenciable si <span class="math notranslate nohighlight">\(\text{dom}f\)</span> es abierto y es diferenciable en cada punto de <span class="math notranslate nohighlight">\(domf.\)</span></p></li>
<li><p>La función: <span class="math notranslate nohighlight">\(f(x) + Df(x)(z-x)\)</span> es afín y se le llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(1\)</span></strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también cerca de <span class="math notranslate nohighlight">\(x\)</span>). Para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span> ésta aproximación es cercana a <span class="math notranslate nohighlight">\(f(z)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> puede encontrarse con la definición de límite anterior o con las derivadas parciales: <span class="math notranslate nohighlight">\(Df(x)_{ij} = \frac{\partial f_i(x)}{\partial x_j}, i=1,\dots,m, j=1,\dots,n\)</span> definidas como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i(x)}{\partial x_j} = \displaystyle \lim_{h \rightarrow 0} \frac{f_i(x+he_j)-f_i(x)}{h}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_i : \mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(i=1,\dots,m,j=1,\dots,n\)</span> y <span class="math notranslate nohighlight">\(e_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésimo vector canónico que tiene un número <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(j\)</span> y <span class="math notranslate nohighlight">\(0\)</span> en las entradas restantes.</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}, Df(x) \in \mathbb{R}^{1\times n}\)</span>, su transpuesta se llama <strong>gradiente</strong>, se denota <span class="math notranslate nohighlight">\(\nabla f(x)\)</span>, es una función <span class="math notranslate nohighlight">\(\nabla f : \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span>, recibe un vector y devuelve un vector columna y sus componentes son derivadas parciales:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = Df(x)^T = 
    \left[ \begin{array}{c}
    \frac{\partial f(x)}{\partial x_1}\\
    \vdots\\
    \frac{\partial f(x)}{\partial x_n}
    \end{array}
    \right] = \left[ 
    \begin{array}{c} 
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_1) - f(x)}{h}\\
    \vdots\\
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_n) - f(x)}{h}
    \end{array}
    \right] \in \mathbb{R}^{n\times 1}.\end{split}\]</div>
<ul class="simple">
<li><p>En este contexto, la aproximación de primer orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es: <span class="math notranslate nohighlight">\(f(x) + \nabla f(x)^T(z-x)\)</span> para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Cuando tienes una función que va de R^n a R^m, la derivada es una matriz de mxn</p></li>
</ul>
</div>
<div class="section" id="id3">
<h3>Notación<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(\mathcal{C}^n(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ con } n \text{ derivadas continuas en su dominio}\}\)</span>.</p>
</div>
<div class="section" id="id4">
<h3>Ejemplo<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f : \mathbb{R}^2 \rightarrow \mathbb{R}^2\)</span> dada por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = 
\left [ 
\begin{array}{c}
x_1x_2 + x_2^2\\
x_1^2 + 2x_1x_2 + x_2^2\\
\end{array}
\right ]
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(x = (x_1, x_2)^T\)</span>. Calcular la derivada de <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Definimos funciones <span class="math notranslate nohighlight">\(f_1, f_2\)</span> que son componentes del vector <span class="math notranslate nohighlight">\(f(x)\)</span></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>          2
x₁⋅x₂ + x₂ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  2               2
x₁  + 2⋅x₁⋅x₂ + x₂ 
</pre></div>
</div>
</div>
</div>
<p><strong>Derivadas parciales:</strong></p>
<p>Para <span class="math notranslate nohighlight">\(f_1(x) = x_1x_2 + x_2^2\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_1\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">df1_x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>x₂
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_1\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">df1_x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>x₁ + 2⋅x₂
</pre></div>
</div>
</div>
</div>
<p>Para <span class="math notranslate nohighlight">\(f_2(x) = x_1^2 + 2x_1 x_2 + x_2^2\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_2\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x1</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">df2_x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2⋅x₁ + 2⋅x₂
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_2\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x2</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">df2_x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2⋅x₁ + 2⋅x₂
</pre></div>
</div>
</div>
</div>
<p><strong>Entonces la derivada es:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}Df(x) = 
\left [
\begin{array}{cc}
x_2 &amp; x_1+2x_2\\
2x_1 + 2x_2 &amp; 2x_1+2x_2
\end{array}
\right ]
\end{split}\]</div>
<p><strong>Otra opción más fácil es utilizando <a class="reference external" href="https://docs.sympy.org/latest/tutorial/matrices.html">Matrices</a>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡              2    ⎤
⎢    x₁⋅x₂ + x₂     ⎥
⎢                   ⎥
⎢  2               2⎥
⎣x₁  + 2⋅x₁⋅x₂ + x₂ ⎦
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Jacobiana de <span class="math notranslate nohighlight">\(f\)</span></strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡    x₂        x₁ + 2⋅x₂ ⎤
⎢                        ⎥
⎣2⋅x₁ + 2⋅x₂  2⋅x₁ + 2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<p><strong>Para evaluar por ejemplo en <span class="math notranslate nohighlight">\((x_1, x_2)^T = (0, 1)^T\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡1  2⎤
⎢    ⎥
⎣2  2⎦
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="regla-de-la-cadena">
<h2>Regla de la cadena<a class="headerlink" href="#regla-de-la-cadena" title="Permalink to this headline">¶</a></h2>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x\in \text{intdom}f\)</span> y <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span> es diferenciable en <span class="math notranslate nohighlight">\(f(x)\in \text{intdom}g\)</span>, se define la composición <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span> por <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span>, la cual es diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, con derivada:</p>
<div class="math notranslate nohighlight">
\[Dh(x)=Dg(f(x))Df(x)\in \mathbb{R}^{p\times n}.\]</div>
</div>
<div class="section" id="ej1">
<span id="id5"></span><h3>Ejemplo<a class="headerlink" href="#ej1" title="Permalink to this headline">¶</a></h3>
<p>Sean <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(g:\mathbb{R} \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[Dh(x) = Dg(f(x))Df(x) = \frac{dg(f(x))}{dx}\nabla f(x)^T \in \mathbb{R}^{1\times n}\]</div>
<p>y la transpuesta de <span class="math notranslate nohighlight">\(Dh(x)\)</span> es: <span class="math notranslate nohighlight">\(\nabla h(x) = Dh(x)^T = \frac{dg(f(x))}{dx} \nabla f(x) \in \mathbb{R}^{n\times 1}\)</span>.</p>
</div>
<div class="section" id="id6">
<h3>Ejemplo<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f(x) = \cos(x), g(x)=\sin(x)\)</span> por lo que <span class="math notranslate nohighlight">\(h(x) = \sin(\cos(x))\)</span>. Calcular la derivada de <span class="math notranslate nohighlight">\(h\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>cos(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>sin(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>sin(cos(x))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-sin(x)⋅cos(cos(x))
</pre></div>
</div>
</div>
</div>
<p><strong>Otras formas para calcular la derivada de la composición <span class="math notranslate nohighlight">\(h\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-sin(x)⋅cos(cos(x))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-sin(x)⋅cos(cos(x))
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h3>Ejemplo<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f(x) = x_1 + \frac{1}{x_2}, g(x) = e^x\)</span> por lo que <span class="math notranslate nohighlight">\(h(x) = e^{x_1 + \frac{1}{x_2}}\)</span>. Calcular la derivada de <span class="math notranslate nohighlight">\(h\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>     1 
x₁ + ──
     x₂
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">exp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>exp
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>      1 
 x₁ + ──
      x₂
ℯ       
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(h\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>      1 
 x₁ + ──
      x₂
ℯ       
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(h\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>       1  
  x₁ + ── 
       x₂ 
-ℯ        
──────────
     2    
   x₂     
</pre></div>
</div>
</div>
</div>
<p><strong>Otra forma para calcular el gradiente de <span class="math notranslate nohighlight">\(h\)</span> (derivada de <span class="math notranslate nohighlight">\(h\)</span>) es utilizando <a class="reference external" href="https://stackoverflow.com/questions/39558515/how-to-get-the-gradient-and-hessian-sympy">how-to-get-the-gradient-and-hessian-sympy</a>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡                 1  ⎤
⎢      1     x₁ + ── ⎥
⎢ x₁ + ──         x₂ ⎥
⎢      x₂  -ℯ        ⎥
⎢ℯ         ──────────⎥
⎢               2    ⎥
⎣             x₂     ⎦
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="caso-particular">
<span id="cp1"></span><h3>Caso particular<a class="headerlink" href="#caso-particular" title="Permalink to this headline">¶</a></h3>
<p>Sean:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(f(x) = Ax +b\)</span> con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n},b \in \mathbb{R}^m\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}^p\)</span>, <span class="math notranslate nohighlight">\(h(x)=g(f(x))=g(Ax+b)\)</span> con <span class="math notranslate nohighlight">\(\text{dom}h=\{z \in \mathbb{R}^n | Az+b \in \text{dom}g\}\)</span> entonces:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Dh(x) = Dg(f(x))Df(x)=Dg(Ax+b)A.\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si <span class="math notranslate nohighlight">\(p=1\)</span>, <span class="math notranslate nohighlight">\(g: \mathbb{R}^m \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[\nabla h(x) = Dh(x)^T = A^TDg(Ax+b)^T=A^T\nabla g(Ax+b) \in \mathbb{R}^{n\times 1}.\]</div>
</div>
</div>
<div class="section" id="ejrestriccionalinea">
<span id="id8"></span><h3>Ejemplo<a class="headerlink" href="#ejrestriccionalinea" title="Permalink to this headline">¶</a></h3>
<p>Este caso particular considera un caso importante en el que se tienen funciones restringidas a una línea. Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> está dada por <span class="math notranslate nohighlight">\(g(t) = f(x+tv)\)</span> con <span class="math notranslate nohighlight">\(x, v \in \mathbb{R}^n\)</span> y <span class="math notranslate nohighlight">\(t \in \mathbb{R}\)</span>, entonces escribimos que <span class="math notranslate nohighlight">\(g\)</span> es <span class="math notranslate nohighlight">\(f\)</span> pero restringida a la línea <span class="math notranslate nohighlight">\(x+tv\)</span>. La derivada de <span class="math notranslate nohighlight">\(g\)</span> es:</p>
<div class="math notranslate nohighlight">
\[Dg(t) = \nabla f(x+tv)^T v.\]</div>
<p>El escalar <span class="math notranslate nohighlight">\(Dg(0) = \nabla f(x)^Tv\)</span> se llama <strong>derivada direccional</strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> en la dirección <span class="math notranslate nohighlight">\(v\)</span>. Un dibujo en el que se considera <span class="math notranslate nohighlight">\(\Delta x: = v\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/18udjmzmmd7drrz/line_search_backtracking_1.png?dl=0" heigth="300" width="300">
<p>Como ejemplo considérese <span class="math notranslate nohighlight">\(f(x) = x_1 ^2 + x_2^2\)</span> con <span class="math notranslate nohighlight">\(x=(x_1, x_2)^T\)</span> y <span class="math notranslate nohighlight">\(g(t) = f(x+tv)\)</span> para <span class="math notranslate nohighlight">\(v=(v_1, v_2)^T\)</span> vector fijo y <span class="math notranslate nohighlight">\(t \in \mathbb{R}\)</span>. Calcular <span class="math notranslate nohighlight">\(Dg(t)\)</span>.</p>
<p><strong>Primera opción</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  2     2
x₁  + x₂ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;v1, v2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_args_for_f_function</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x1</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">v1</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">v2</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">new_args_for_f_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>           2              2
(t⋅v₁ + x₁)  + (t⋅v₂ + x₂) 
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(g\)</span> respecto a <span class="math notranslate nohighlight">\(t\)</span>: <span class="math notranslate nohighlight">\(Dg(t)=\nabla f(x+tv)^T v\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2⋅v₁⋅(t⋅v₁ + x₁) + 2⋅v₂⋅(t⋅v₂ + x₂)
</pre></div>
</div>
</div>
</div>
<p><strong>Segunda opción para calcular la derivada utilizando vectores:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡x₁⎤
⎢  ⎥
⎣x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_arg_f_function</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">new_arg_f_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡t⋅v₁ + x₁⎤
⎢         ⎥
⎣t⋅v₂ + x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_for_g_function</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                          <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">mapping_for_g_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>           2              2
(t⋅v₁ + x₁)  + (t⋅v₂ + x₂) 
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(g\)</span> respecto a <span class="math notranslate nohighlight">\(t\)</span>: <span class="math notranslate nohighlight">\(Dg(t)=\nabla f(x+tv)^T v\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2⋅v₁⋅(t⋅v₁ + x₁) + 2⋅v₂⋅(t⋅v₂ + x₂)
</pre></div>
</div>
</div>
</div>
<p><strong>Tercera opción definiendo a la función <span class="math notranslate nohighlight">\(f\)</span> a partir de <span class="math notranslate nohighlight">\(x\)</span> symbol Matrix:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡x₁⎤
⎢  ⎥
⎣x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  2     2
x₁  + x₂ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">new_arg_f_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡t⋅v₁ + x₁⎤
⎢         ⎥
⎣t⋅v₂ + x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>           2              2
(t⋅v₁ + x₁)  + (t⋅v₂ + x₂) 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(g\)</span> respecto a <span class="math notranslate nohighlight">\(t\)</span>: <span class="math notranslate nohighlight">\(Dg(t)=\nabla f(x+tv)^T v\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2⋅v₁⋅(t⋅v₁ + x₁) + 2⋅v₂⋅(t⋅v₂ + x₂)
</pre></div>
</div>
</div>
</div>
<p><strong>En lo siguiente se utiliza <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/array.html#derivatives-by-array">derive-by_array</a>, <a class="reference external" href="https://stackoverflow.com/questions/39558515/how-to-get-the-gradient-and-hessian-sympy">how-to-get-the-gradient-and-hessian-sympy</a> para mostrar cómo se puede hacer un producto punto con SymPy</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡2⋅x₁⎤
⎢    ⎥
⎣2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡2⋅t⋅v₁ + 2⋅x₁⎤
⎢             ⎥
⎣2⋅t⋅v₂ + 2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gradient_f_new_arg</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                 <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">new_arg_f_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡v₁⎤
⎢  ⎥
⎣v₂⎦
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(g\)</span> respecto a <span class="math notranslate nohighlight">\(t\)</span>: <span class="math notranslate nohighlight">\(Dg(t)=\nabla f(x+tv)^T v = v^T \nabla f(x + tv)\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">gradient_f_new_arg</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>v₁⋅(2⋅t⋅v₁ + 2⋅x₁) + v₂⋅(2⋅t⋅v₂ + 2⋅x₂)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ej2">
<span id="id9"></span><h3>Ejemplo<a class="headerlink" href="#ej2" title="Permalink to this headline">¶</a></h3>
<p>Si <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> dada por <span class="math notranslate nohighlight">\(h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i) \right)\)</span> con <span class="math notranslate nohighlight">\(x\in \mathbb{R}^n,a_i\in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Dh(x)=\left(\displaystyle \sum_{i=1}^m\exp(a_i^Tx+b_i) \right)^{-1}\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}
    \right]^TA=(1^Tz)^{-1}z^TA
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span>. Por lo tanto <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span>.</p>
<p>En este ejemplo <span class="math notranslate nohighlight">\(Dh(x) = Dg(f(x))Df(x)\)</span> con:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x)=g(f(x))\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(g: \mathbb{R}^m \rightarrow \mathbb{R}\)</span> dada por <span class="math notranslate nohighlight">\(g(y)=\log \left( \displaystyle \sum_{i=1}^m \exp(y_i) \right )\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)=Ax+b.\)</span></p></li>
</ul>
<p>Para lo siguiente se utilizó como referencias: <a class="reference external" href="https://stackoverflow.com/questions/41581002/how-to-derive-with-respect-to-a-matrix-element-with-sympy">liga1</a>, <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/indexed.html">liga2</a>, <a class="reference external" href="https://stackoverflow.com/questions/37705571/sum-over-matrix-entries-in-sympy-1-0-with-python-3-5">liga3</a>, <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/array.html">liga4</a>, <a class="reference external" href="https://docs.sympy.org/latest/modules/concrete.html">liga5</a>, <a class="reference external" href="https://stackoverflow.com/questions/51723550/summation-over-a-sympy-array">liga6</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/indexed.html">indexed</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="c1">#for index of sum</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Esta función es la que queremos derivar.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   ⎛  m        ⎞
   ⎜ ___       ⎟
   ⎜ ╲         ⎟
   ⎜  ╲    y[i]⎟
log⎜  ╱   ℯ    ⎟
   ⎜ ╱         ⎟
   ⎜ ‾‾‾       ⎟
   ⎝i = 1      ⎠
</pre></div>
</div>
</div>
</div>
<p><strong>Para un caso de <span class="math notranslate nohighlight">\(m=3\)</span> en la función <span class="math notranslate nohighlight">\(g\)</span> se tiene:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;y1, y2, y3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g_m_3</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">g_m_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   ⎛ y₁    y₂    y₃⎞
log⎝ℯ   + ℯ   + ℯ  ⎠
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/array.html#derivatives-by-array">derive-by_array</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dg_m_3</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">g_m_3</span><span class="p">,</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(g\)</span> respecto a <span class="math notranslate nohighlight">\(y_1, y_2, y_3\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">dg_m_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡       y₁               y₂               y₃      ⎤
⎢      ℯ                ℯ                ℯ        ⎥
⎢───────────────  ───────────────  ───────────────⎥
⎢ y₁    y₂    y₃   y₁    y₂    y₃   y₁    y₂    y₃⎥
⎣ℯ   + ℯ   + ℯ    ℯ   + ℯ   + ℯ    ℯ   + ℯ   + ℯ  ⎦
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker delta</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡  m                 m                 m             ⎤
⎢ ____              ____              ____           ⎥
⎢ ╲                 ╲                 ╲              ⎥
⎢  ╲                 ╲                 ╲             ⎥
⎢   ╲   y[i]          ╲   y[i]          ╲   y[i]     ⎥
⎢   ╱  ℯ    ⋅δ        ╱  ℯ    ⋅δ        ╱  ℯ    ⋅δ   ⎥
⎢  ╱          1,i    ╱          2,i    ╱          3,i⎥
⎢ ╱                 ╱                 ╱              ⎥
⎢ ‾‾‾‾              ‾‾‾‾              ‾‾‾‾           ⎥
⎢i = 1             i = 1             i = 1           ⎥
⎢────────────────  ────────────────  ────────────────⎥
⎢    m                 m                 m           ⎥
⎢   ___               ___               ___          ⎥
⎢   ╲                 ╲                 ╲            ⎥
⎢    ╲    y[i]         ╲    y[i]         ╲    y[i]   ⎥
⎢    ╱   ℯ             ╱   ℯ             ╱   ℯ       ⎥
⎢   ╱                 ╱                 ╱            ⎥
⎢   ‾‾‾               ‾‾‾               ‾‾‾          ⎥
⎣  i = 1             i = 1             i = 1         ⎦
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Esta expresión generaliza la del renglón de arriba</p></li>
</ul>
<p><strong>Para la composición <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span> se utilizan las siguientes celdas:</strong></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://docs.sympy.org/latest/modules/tensor/indexed.html">indexed</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#we want something like:</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>          n               
         ___              
         ╲                
          ╲               
 b[i] +   ╱   A[i, j]⋅x[j]
         ╱                
         ‾‾‾              
        j = 1             
ℯ                         
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#better if we split each step:</span>
<span class="n">arg_sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">arg_sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>A[i, j]⋅x[j]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arg_exp</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">arg_sum</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">arg_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>         n               
        ___              
        ╲                
         ╲               
b[i] +   ╱   A[i, j]⋅x[j]
        ╱                
        ‾‾‾              
       j = 1             
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg_exp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>          n               
         ___              
         ╲                
          ╲               
 b[i] +   ╱   A[i, j]⋅x[j]
         ╱                
         ‾‾‾              
        j = 1             
ℯ                         
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arg_2_sum</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">arg_2_sum</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   m                              
_______                           
╲                                 
 ╲                                
  ╲               n               
   ╲             ___              
    ╲            ╲                
     ╲            ╲               
     ╱   b[i] +   ╱   A[i, j]⋅x[j]
    ╱            ╱                
   ╱             ‾‾‾              
  ╱             j = 1             
 ╱      ℯ                         
╱                                 
‾‾‾‾‾‾‾                           
 i = 1                            
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">arg_2_sum</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)))</span> 
<span class="c1">#complex expression: sympy.log(sympy.Sum(sympy.exp(sympy.Sum(A[i, j]*x[j], (j, 1, n)) + b[i]), (i, 1, m)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   ⎛   m                              ⎞
   ⎜_______                           ⎟
   ⎜╲                                 ⎟
   ⎜ ╲                                ⎟
   ⎜  ╲               n               ⎟
   ⎜   ╲             ___              ⎟
   ⎜    ╲            ╲                ⎟
   ⎜     ╲            ╲               ⎟
log⎜     ╱   b[i] +   ╱   A[i, j]⋅x[j]⎟
   ⎜    ╱            ╱                ⎟
   ⎜   ╱             ‾‾‾              ⎟
   ⎜  ╱             j = 1             ⎟
   ⎜ ╱      ℯ                         ⎟
   ⎜╱                                 ⎟
   ⎜‾‾‾‾‾‾‾                           ⎟
   ⎝ i = 1                            ⎠
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(h\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   m                                                  
________                                              
╲                                                     
 ╲                 n                                  
  ╲               ___                                 
   ╲              ╲                                   
    ╲              ╲                                  
     ╲    b[i] +   ╱   A[i, j]⋅x[j]   n               
      ╲           ╱                  ___              
      ╱           ‾‾‾                ╲                
     ╱           j = 1                ╲   δ   ⋅A[i, j]
    ╱    ℯ                         ⋅  ╱    1,j        
   ╱                                 ╱                
  ╱                                  ‾‾‾              
 ╱                                  j = 1             
╱                                                     
‾‾‾‾‾‾‾‾                                              
 i = 1                                                
──────────────────────────────────────────────────────
             m                                        
          _______                                     
          ╲                                           
           ╲                                          
            ╲               n                         
             ╲             ___                        
              ╲            ╲                          
               ╲            ╲                         
               ╱   b[i] +   ╱   A[i, j]⋅x[j]          
              ╱            ╱                          
             ╱             ‾‾‾                        
            ╱             j = 1                       
           ╱      ℯ                                   
          ╱                                           
          ‾‾‾‾‾‾‾                                     
           i = 1                                      
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker delta</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span> <span class="c1">#we can use also: derive_by_array(h, [x[1], x[2], x[3]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡   m                                                  ⎤
⎢________                                              ⎥
⎢╲                                                     ⎥
⎢ ╲                 n                                  ⎥
⎢  ╲               ___                                 ⎥
⎢   ╲              ╲                                   ⎥
⎢    ╲              ╲                                  ⎥
⎢     ╲    b[i] +   ╱   A[i, j]⋅x[j]   n               ⎥
⎢      ╲           ╱                  ___              ⎥
⎢      ╱           ‾‾‾                ╲                ⎥
⎢     ╱           j = 1                ╲   δ   ⋅A[i, j]⎥
⎢    ╱    ℯ                         ⋅  ╱    1,j        ⎥
⎢   ╱                                 ╱                ⎥
⎢  ╱                                  ‾‾‾              ⎥
⎢ ╱                                  j = 1             ⎥
⎢╱                                                     ⎥
⎢‾‾‾‾‾‾‾‾                                              ⎥
⎢ i = 1                                                ⎥
⎢──────────────────────────────────────────────────────⎥
⎢             m                                        ⎥
⎢          _______                                     ⎥
⎢          ╲                                           ⎥
⎢           ╲                                          ⎥
⎢            ╲               n                         ⎥
⎢             ╲             ___                        ⎥
⎢              ╲            ╲                          ⎥
⎢               ╲            ╲                         ⎥
⎢               ╱   b[i] +   ╱   A[i, j]⋅x[j]          ⎥
⎢              ╱            ╱                          ⎥
⎢             ╱             ‾‾‾                        ⎥
⎢            ╱             j = 1                       ⎥
⎢           ╱      ℯ                                   ⎥
⎢          ╱                                           ⎥
⎢          ‾‾‾‾‾‾‾                                     ⎥
⎣           i = 1                                      ⎦
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Pregunta</p>
<p>¿Se puede resolver este ejercicio con <a class="reference external" href="https://docs.sympy.org/latest/modules/matrices/expressions.html">Matrix Symbol</a>?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Verificar que lo obtenido con SymPy es igual a lo desarrollado en “papel” al inicio del <a class="reference internal" href="#ej2"><span class="std std-ref">Ejemplo</span></a></p>
</div>
</div>
</div>
<div class="section" id="segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h2>Segunda derivada de una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span>.<a class="headerlink" href="#segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h2>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Sea <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>. La segunda derivada o matriz <strong>Hessiana</strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> existe si <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, se denota <span class="math notranslate nohighlight">\(\nabla^2f(x)\)</span> y sus componentes son segundas derivadas parciales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x) = \left[\begin{array}{cccc}
\frac{\partial^2f(x)}{\partial x_1^2} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_1}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_1}\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_2} &amp;\frac{\partial^2f(x)}{\partial x_2^2} &amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_n} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_n}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n^2} \\
\end{array}
\right]
\end{split}\]</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios:</p>
<ul class="simple">
<li><p>La aproximación de segundo orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también para puntos cercanos a <span class="math notranslate nohighlight">\(x\)</span>) es la función cuadrática en la variable <span class="math notranslate nohighlight">\(z\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) + \nabla f(x)^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)\]</div>
<ul class="simple">
<li><p>Se cumple:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{|f(z)-[f(x)+\nabla f(x)^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)]|}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<ul class="simple">
<li><p>Se tiene lo siguiente:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\nabla f\)</span> es una función nombrada <em>gradient mapping</em> (o simplemente gradiente).</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla f:\mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> tiene regla de correspondencia <span class="math notranslate nohighlight">\(\nabla f(x)\)</span> (evaluar en <span class="math notranslate nohighlight">\(x\)</span> la matriz <span class="math notranslate nohighlight">\(Df(\cdot)^T\)</span>).</p></li>
<li><p>Se dice que <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span> si <span class="math notranslate nohighlight">\(\text{dom}f\)</span> es abierto y <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en cada punto de <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(D\nabla f(x) = \nabla^2f(x)\)</span> para <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla ^2 f(x) : \mathbb{R}^n \rightarrow \mathbb{R}^{n \times n}\)</span>.</p></li>
<li><p><strong>Importante:</strong> si <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{dom}f)\)</span> entonces la Hessiana es una matriz simétrica.</p></li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Las matrices simétricas tienen propiedades muy útiles para el análisis numérico</p></li>
</ul>
</div>
<div class="section" id="regla-de-la-cadena-para-la-segunda-derivada">
<h2>Regla de la cadena para la segunda derivada<a class="headerlink" href="#regla-de-la-cadena-para-la-segunda-derivada" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cp2">
<span id="id10"></span><h3>Caso particular<a class="headerlink" href="#cp2" title="Permalink to this headline">¶</a></h3>
<p>Sean:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(g:\mathbb{R} \rightarrow \mathbb{R}\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con  <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span>, entonces:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\nabla^2h(x) = D\nabla h(x)\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="#ej1"><span class="std std-ref">Ejemplo 1 de la regla de la cadena</span></a></p>
</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[\nabla h(x)=Dh(x)^T = (Dg(f(x))Df(x))^T=\frac{dg(f(x))}{dx}\nabla f(x)\]</div>
<p>por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla^2 h(x) &amp;=&amp; D\nabla h(x) \nonumber \\
&amp;=&amp; D \left(\frac{dg(f(x))}{dx}\nabla f(x)\right) \nonumber \\
&amp;=&amp; \frac{dg(f(x))}{dx}\nabla^2 f(x)+\left(\frac{d^2g(f(x))}{dx}\nabla f(x) \nabla f(x)^T \right)^T \nonumber \\
&amp;=&amp; \frac{dg(f(x))}{dx}\nabla^2 f(x)+\frac{d^2g(f(x))}{dx} \nabla f(x) \nabla f(x)^T \nonumber
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="cp3">
<span id="id11"></span><h3>Caso particular<a class="headerlink" href="#cp3" title="Permalink to this headline">¶</a></h3>
<p>Sean:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m, f(x) = Ax+b\)</span> con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n}\)</span>, <span class="math notranslate nohighlight">\(b \in \mathbb{R}^m\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span>, <span class="math notranslate nohighlight">\(h(x) = g(f(x)) = g(Ax+b)\)</span> con <span class="math notranslate nohighlight">\(\text{dom}h=\{z \in \mathbb{R}^n | Az+b \in \text{dom}g\}\)</span> entonces:</p></li>
</ul>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="#cp1"><span class="std std-ref">Caso particular</span></a> para la expresión de la derivada.</p>
</div>
<div class="math notranslate nohighlight">
\[Dh(x)^T = Dg(f(x))Df(x) = Dg(Ax+b)A.\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si <span class="math notranslate nohighlight">\(p=1\)</span>, <span class="math notranslate nohighlight">\(g: \mathbb{R}^m \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[\nabla^2h(x) = D \nabla h(x) = A^T \nabla^2g(Ax+b)A.\]</div>
</div>
</div>
<div class="section" id="id12">
<h3>Ejemplo<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="#ejrestriccionalinea"><span class="std std-ref">Ejemplo</span></a></p>
</div>
<p>Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> está dada por <span class="math notranslate nohighlight">\(g(t) = f(x+tv)\)</span> con <span class="math notranslate nohighlight">\(x,v \in \mathbb{R}^n, t \in \mathbb{R}\)</span>, esto es, <span class="math notranslate nohighlight">\(g\)</span> es <span class="math notranslate nohighlight">\(f\)</span> pero restringida a la línea <span class="math notranslate nohighlight">\(\{x+tv|t \in \mathbb{R}\}\)</span> , entonces:</p>
<div class="math notranslate nohighlight">
\[Dg(t) = Df(x+tv)v = \nabla f(x+tv)^Tv\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\nabla ^2g(t) = D\nabla f(x+tv)^Tv=v^T\nabla^2f(x+tv)v.\]</div>
</div>
<div class="section" id="id13">
<h3>Ejemplo<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="#ej2"><span class="std std-ref">Ejemplo</span></a></p>
</div>
<p>Si <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}, h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i)\right)\)</span> con <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n, a_i \in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span>.</p>
<p>Como se desarrolló anteriormente <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span> con <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span> y <span class="math notranslate nohighlight">\(A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}.\)</span></p>
<p>Por lo que</p>
<div class="math notranslate nohighlight">
\[\nabla^2 h(x) = D\nabla h(x) = A^T \nabla^2g(Ax+b)A\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(\nabla^2 g(y)\)</span> se obtiene de acuerdo a <a class="reference internal" href="#cp2"><span class="std std-ref">Caso particular</span></a> tomando <span class="math notranslate nohighlight">\(\log:\mathbb{R} \rightarrow \mathbb{R}, \displaystyle \sum_{i=1}^m \exp(y_i): \mathbb{R}^m \rightarrow \mathbb{R}\)</span></p>
</div>
<p>donde: <span class="math notranslate nohighlight">\(\nabla^2g(y)=(1^Ty)^{-1}\text{diag}(y)-(1^Ty)^{-2}yy^T\)</span>.</p>
<div class="math notranslate nohighlight">
\[\therefore  \nabla^2 h(x) = A^T\left[(1^Tz)^{-1}\text{diag}(z)-(1^Tz)^{-2}zz^T \right]A\]</div>
<p>y <span class="math notranslate nohighlight">\(\text{diag}(c)\)</span> es una matriz diagonal con elementos en su diagonal iguales a las entradas del vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Verificar con el paquete de SymPy las expresiones para la segunda derivada de los dos ejemplos anteriores.</p>
</div>
</div>
</div>
<div class="section" id="tablita-util-para-formulas-de-diferenciacion-con-el-operador-nabla">
<h2>Tablita útil para fórmulas de diferenciación con el operador <span class="math notranslate nohighlight">\(\nabla\)</span><a class="headerlink" href="#tablita-util-para-formulas-de-diferenciacion-con-el-operador-nabla" title="Permalink to this headline">¶</a></h2>
<p>Sean <span class="math notranslate nohighlight">\(f,g:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(f,g \in \mathcal{C}^2\)</span> respectivamente en sus dominios y <span class="math notranslate nohighlight">\(\alpha_1, \alpha_2 \in \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span>, <span class="math notranslate nohighlight">\(b \in \mathbb{R}^n\)</span> son fijas. Diferenciando con respecto a la variable <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> se tiene:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>linealidad</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\nabla(\alpha_1 f(x) + \alpha_2 g(x)) = \alpha_1 \nabla f(x) + \alpha_2 \nabla g(x)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>producto</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\nabla(f(x)g(x)) = \nabla f(x) g(x) + f(x) \nabla g(x)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>producto punto</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\nabla(b^Tx) = b\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>cuadrático</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\nabla(x^TAx) = 2(A+A^T)x\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>segunda derivada</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\nabla^2(Ax)=A\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="comentario-respecto-al-computo-simbolico-o-algebraico-y-numerico">
<h2>Comentario respecto al cómputo simbólico o algebraico y númerico<a class="headerlink" href="#comentario-respecto-al-computo-simbolico-o-algebraico-y-numerico" title="Permalink to this headline">¶</a></h2>
<p>Si bien el cómputo simbólico o algebraico nos ayuda a calcular las expresiones para las derivadas evitando los problemas de errores por redondeo que se revisarán en <a class="reference internal" href="../1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html#ptdn"><span class="std std-ref">Polinomios de Taylor y diferenciación numérica</span></a>, la complejidad de las expresiones que internamente se manejan es ineficiente vs el cómputo numérico, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Computer_algebra#Computer_science_aspects">Computer science aspects of computer algebra</a> y <a class="reference external" href="https://en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Library">GNU_Multiple_Precision_Arithmetic_Library</a>.</p>
<p>Como ejemplo de la precisión arbitraria que se puede manejar con el cómputo simbólico o algebraico vs el <a class="reference internal" href="../1.2/Sistema_de_punto_flotante.html#spf"><span class="std std-ref">Sistema en punto flotante</span></a> considérese el cálculo siguiente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.16e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2.2204460492503131e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eps_sympy</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.16e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">eps_sympy</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0.0000000000000000e+00
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./I.computo_cientifico/1.5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html" title="previous page">1.4 Condición de un problema y estabilidad de un algoritmo</a>
    <a class='right-next' id="next-link" href="../1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html" title="next page">1.6 Polinomios de Taylor y diferenciación numérica</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>