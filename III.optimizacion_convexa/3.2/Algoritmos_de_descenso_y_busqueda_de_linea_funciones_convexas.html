

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.2 Algoritmos de descenso y búsqueda de línea para funciones convexas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.3 Ecuaciones no lineales" href="../3.3/Ecuaciones_no_lineales.html" />
    <link rel="prev" title="3.1 Definición de problemas de optimización, conjuntos y funciones convexas" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3.2 Algoritmos de descenso y búsqueda de línea para funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3.3/Ecuaciones_no_lineales.html">
   3.3 Ecuaciones no lineales
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplos-de-problemas-de-optimizacion-small-scale">
   Ejemplos de problemas de optimización
   <em>
    small scale
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f">
     ¿Por qué fue un poco complicado determinar el conjunto de mínimos de
     <span class="math notranslate nohighlight">
      \(f\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-importante">
     Ejemplo importante
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-de-descenso-para-funciones-convexas">
   Métodos de descenso para funciones convexas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#secuencia-de-minimizacion">
     Secuencia de minimización
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paso-o-direccion-de-busqueda-y-tamano-o-longitud-de-paso">
     Paso o dirección de búsqueda y tamaño o longitud de paso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso">
     Condición para que un paso o dirección de búsqueda sea de descenso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algoritmo-metodo-general-de-descenso-para-funciones-convexas">
     Algoritmo: método general de descenso para funciones convexas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-de-funcion-objetivo-convexa">
     Ejemplo de función objetivo convexa
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-de-busqueda-de-linea-por-backtracking">
   Método de búsqueda de línea por
   <em>
    backtracking
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algoritmo-busqueda-de-linea-por-backtracking">
     Algoritmo: búsqueda de línea por
     <em>
      backtracking
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-en-python-para-el-metodo-de-backtracking">
   Función en Python para el método de
   <em>
    backtracking
   </em>
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="algoritmos-de-descenso-y-busqueda-de-linea-para-funciones-convexas">
<span id="onam"></span><h1>3.2 Algoritmos de descenso y búsqueda de línea para funciones convexas<a class="headerlink" href="#algoritmos-de-descenso-y-busqueda-de-linea-para-funciones-convexas" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://drive.google.com/file/d/16-_PvWNaO0Zc9x04-SRsxCRdn5fxebf2/view">liga</a>.</p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Aprenderá la importancia de resolver ecuaciones no lineales para encontrar mínimos locales de funciones.</p></li>
<li><p>Comprenderá el uso de la información de primer y segundo orden para resolver problemas de minimización de funciones convexas mediante los algoritmos general de descenso y de búsqueda de línea por <em>backtracking</em>.</p></li>
</ul>
</div>
<div class="section" id="ejemplos-de-problemas-de-optimizacion-small-scale">
<h2>Ejemplos de problemas de optimización <em>small scale</em><a class="headerlink" href="#ejemplos-de-problemas-de-optimizacion-small-scale" title="Permalink to this headline">¶</a></h2>
<p>En optimización la búsqueda del (o los) <strong>óptimo(s)</strong> involucran el cálculo de información de primer o segundo orden, ver <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">Definición de función, continuidad y derivada</span></a>, de la función <span class="math notranslate nohighlight">\(f_o\)</span> de acuerdo a lo revisado en los <span class="xref std std-ref">resultados útiles de teoría de convexidad</span>. Tal información para problemas <em>small scale</em> es calculada utilizando todos los datos en un enfoque por <em>batch</em> o lote.</p>
<div class="section" id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} x_1^4+2x_1^2x_2+x_2^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Los candidatos a ser mínimos los encontramos al calcular el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> que podemos calcular con <em>SymPy</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  4       2        2
x₁  + 2⋅x₁ ⋅x₂ + x₂ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡    3                2       ⎤
⎣4⋅x₁  + 4⋅x₁⋅x₂  2⋅x₁  + 2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<p>y plantear:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla f_o(x) = 
\left [
\begin{array}{c}
4x_1^3+4x_1x_2\\
2x_1^2+2x_2
\end{array}
\right ]=0
\end{split}\]</div>
<p>la cual es una ecuación de dos variables y dos incógnitas <strong>no lineal</strong>. Resolviendo para <span class="math notranslate nohighlight">\(x_2\)</span> se obtiene la relación: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>. Entonces todos los puntos con coordenadas <span class="math notranslate nohighlight">\(x = (x_1, x_2)\)</span> que satisfacen tal relación cumplen <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span>. ¿Todos serán mínimos locales?</p>
<p><strong>Gráfica de la superficie <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fo_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_np</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x2_np</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">z_np</span> <span class="o">=</span> <span class="n">fo_numpy</span><span class="p">([</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">])</span>
<span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">,</span> <span class="n">z_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(0, 0, 0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_26_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_26_0.png" />
</div>
</div>
<p><strong>Gráfica de las curvas de nivel de <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span><span class="p">,</span><span class="n">z_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_29_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_29_0.png" />
</div>
</div>
<p>Resolvamos con <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve">scipy.optimize.fsolve</a> la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eqn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="n">x</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Elegimos diferentes puntos iniciales.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root1</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root2</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root3</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dic_roots</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">root1</span><span class="p">,</span>
             <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">root2</span><span class="p">,</span>
             <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">root3</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code>, <code class="docutils literal notranslate"><span class="pre">root3</span></code> satisfacen la relación <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic_roots</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   root1  root2  root3
0    1.0   -1.0    2.0
1   -1.0   -1.0   -4.0
</pre></div>
</div>
</div>
</div>
<p>Al evaluar el gradiente en cada punto obtenemos cero (o cercano a cero):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                       <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">partial_derivative</span> <span class="ow">in</span> <span class="n">gf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root1</span><span class="p">),</span>
       <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root2</span><span class="p">),</span>
       <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root3</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code> y <code class="docutils literal notranslate"><span class="pre">root3</span></code> resuelven la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f(x) = 0\)</span> .</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   root1  root2  root3
0    0.0    0.0    0.0
1    0.0   -0.0    0.0
</pre></div>
</div>
</div>
</div>
<p><strong>¿Cómo podemos identificar si son mínimos? …</strong> usamos la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡     2             ⎤
⎢12⋅x₁  + 4⋅x₂  4⋅x₁⎥
⎢                   ⎥
⎣    4⋅x₁        2  ⎦
</pre></div>
</div>
</div>
</div>
<p>y revisamos eigenvalores de la Hessiana evaluada en los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code>, <code class="docutils literal notranslate"><span class="pre">root3</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                              <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">Hf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_root1</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root1</span><span class="p">)</span>
<span class="n">Hf_root2</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root2</span><span class="p">)</span>
<span class="n">Hf_root3</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root1</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[10.  0.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root2</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[10. -0.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root3</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[34.  0.]
</pre></div>
</div>
</div>
</div>
<p>Tenemos un criterio para <span class="math notranslate nohighlight">\(2\)</span> dimensiones:</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Sea <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{intdom}f)\)</span>, <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x))\)</span> determinante de la Hessiana y <span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span> un punto crítico o estacionario de <span class="math notranslate nohighlight">\(f\)</span>:</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &lt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>máximo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &gt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>mínimo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &lt; 0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>punto silla o <a class="reference external" href="https://en.wikipedia.org/wiki/Saddle_point"><em>saddle point</em></a></strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) = 0\)</span> no podemos concluir si <span class="math notranslate nohighlight">\(x\)</span> es extremo.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>Al determinante de la Hessiana de <span class="math notranslate nohighlight">\(f\)</span> se le nombra <strong>Hessiano</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Lo anterior es un caso particular de los resultados descritos en <span class="xref std std-ref">sobre puntos críticos</span>.</p></li>
</ul>
</div>
<p>En el ejemplo el Hessiano es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>    2       
8⋅x₁  + 8⋅x₂
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los tres puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code> y <code class="docutils literal notranslate"><span class="pre">root3</span></code> satisfacen <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</div>
<p>El cual se anula justo en los puntos que cumplen: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span></p>
<p><span class="math notranslate nohighlight">\(8x_1^2 + 8x_2 = 8 x_1^2 + 8(-x_1^2) = 0\)</span></p>
<p>por lo que no podemos concluir…</p>
<p>Usemos una función de <em>SciPy</em> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html">scipy.optimize.fmin</a></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Elegimos un punto inicial.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res_fmin</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">fo_numpy</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 56
         Function evaluations: 110
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El punto <code class="docutils literal notranslate"><span class="pre">res_fmin</span></code> satisface <span class="math notranslate nohighlight">\(\nabla f(x) = 0\)</span> y la relación <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.063 -0.004]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.  0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_fmin</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">res_fmin</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_fmin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[0.    2.032]
</pre></div>
</div>
</div>
</div>
<p>Grafiquemos los puntos que cumplen <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point1</span> <span class="o">=</span> <span class="p">(</span><span class="n">root1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root1</span><span class="p">))</span>
<span class="n">point2</span> <span class="o">=</span> <span class="p">(</span><span class="n">root2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
<span class="n">point3</span> <span class="o">=</span> <span class="p">(</span><span class="n">root3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root3</span><span class="p">))</span>
<span class="c1">#another point:</span>
<span class="n">point4</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_plot2</span><span class="p">,</span> <span class="o">-</span><span class="n">x1_plot2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_78_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_78_0.png" />
</div>
</div>
<p>Evaluemos en un rango más amplio la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> y realicemos una gráfica</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_81_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_funciones_convexas_81_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z_plot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p><strong>El mínimo valor de <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(0\)</span> por lo que tenemos un conjunto de mínimos dados por la curva <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span>.</strong></p>
</div>
<div class="section" id="por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f">
<h3>¿Por qué fue un poco complicado determinar el conjunto de mínimos de <span class="math notranslate nohighlight">\(f\)</span>?<a class="headerlink" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f" title="Permalink to this headline">¶</a></h3>
<p><strong><span class="math notranslate nohighlight">\(f(x)=x_1^4+2x_1^2x_2+x_2^2\)</span> no es una función convexa en su <span class="math notranslate nohighlight">\(\text{dom}f\)</span></strong>, <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, esto es, no satisface la desigualdad:</p>
<div class="math notranslate nohighlight">
\[f(\theta x + (1-\theta) y) \leq \theta f(x) + (1-\theta)f(y)\]</div>
<p><span class="math notranslate nohighlight">\(\forall x,y\)</span> en su dominio y <span class="math notranslate nohighlight">\(\forall \theta \in [0,1]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pointx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">pointy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point_convex_combination</span> <span class="o">=</span> <span class="n">theta</span><span class="o">*</span><span class="n">pointx</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">pointy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">point_convex_combination</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2.25
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se tiene <span class="math notranslate nohighlight">\(f(\theta x + (1-\theta)y) &gt; \theta f(x) + (1-\theta)f(y)\)</span> con la elección <span class="math notranslate nohighlight">\(\theta=0.5\)</span>, <span class="math notranslate nohighlight">\(x=[-0.5, -1.5]^T\)</span>, <span class="math notranslate nohighlight">\(y=[0.5, -1.5]^T\)</span> lo que indica que <span class="math notranslate nohighlight">\(f\)</span> no es convexa sino cóncava para esta elección de puntos <span class="math notranslate nohighlight">\(x,y\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">pointx</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">pointy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1.5625
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ejemplo-importante">
<h3>Ejemplo importante<a class="headerlink" href="#ejemplo-importante" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{1}{2}x^TPx+q^Tx+r\]</div>
<p>donde: <span class="math notranslate nohighlight">\(P=\left [\begin{array}{cc} 5 &amp; 4\\ 4 &amp; 5 \end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(q=\left [\begin{array}{c} -1\\ 1 \end{array} \right]\)</span>, <span class="math notranslate nohighlight">\(r=3\)</span>.</p>
<p>Haciendo las multiplicaciones de matriz-vector y productos punto</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">q</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>      2                          2         
2.5⋅x₁  + 4.0⋅x₁⋅x₂ - x₁ + 2.5⋅x₂  + x₂ + 3
</pre></div>
</div>
</div>
</div>
<p>se <strong>reescribe</strong> el problema de optimización como:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{5}{2}x_1^2 + \frac{5}{2}x_2^2+4x_1x_2 -x_1 + x_2+3\]</div>
<p>La función objetivo es una <strong>función estrictamente convexa</strong> en <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> (de hecho <strong>fuertemente convexa</strong>) pues:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los eigenvalores de <span class="math notranslate nohighlight">\(P\)</span> son <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(9\)</span> de multiplicidad simple cada uno.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{1: 1, 9: 1}
</pre></div>
</div>
</div>
</div>
<p>y la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)),</span>
                             <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">))</span>
             <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡5.0  4.0⎤
⎢        ⎥
⎣4.0  5.0⎦
</pre></div>
</div>
</div>
</div>
<p>El gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡5.0⋅x₁ + 4.0⋅x₂ - 1⎤
⎢                   ⎥
⎣4.0⋅x₁ + 5.0⋅x₂ + 1⎦
</pre></div>
</div>
</div>
</div>
<p>El mínimo debe satisfacer la ecuación <strong>lineal</strong> con dos variables y dos ecuaciones</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_o(x) = Px +q =\left [ \begin{array}{cc}
5 &amp; 4\\
4 &amp; 5
\end{array}
\right ]
\left [ \begin{array}{c}
x_1\\
x_2
\end{array}
\right ]
+ \left [ \begin{array}{c}
-1\\
1
\end{array}
\right ]=
\left [ \begin{array}{cc}
5x_1+4x_2-1\\
4x_1+5x_2+1
\end{array}
\right ]
=0
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En algunos casos especiales es posible resolver la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> para <span class="math notranslate nohighlight">\(x\)</span> de forma analítica o cerrada. Este es el caso de este ejemplo cuya solución está dada por <span class="math notranslate nohighlight">\(x^* = -P^{-1}q\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 1. -1.]
</pre></div>
</div>
</div>
</div>
<p>El problema anterior también lo podemos resolver con <a class="reference external" href="https://github.com/cvxgrp/cvxpy">cvxpy</a> pues es un <strong>problema convexo</strong> sin restricciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#number of variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#optimization variable</span>
<span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="o">.</span><span class="n">quad_form</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span> <span class="c1">#objective function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opt_objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span> <span class="c1">#optimization objective</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">opt_objective</span><span class="p">)</span> <span class="c1">#optimization problem</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>-0.9999999999999993
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status:&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal value&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal var&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>status: optimal
optimal value -0.9999999999999993
optimal var [ 1. -1.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>El paquete cvxpy requiere que se especifique el problema de optimización a resolver siguiendo reglas establecidas en <a class="reference external" href="https://dcp.stanford.edu/">Disciplined Convex Programming</a>. En el ejemplo anterior resulta en un error si se ejecutan las líneas siguientes:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">fo</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">+</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="mi">3</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>La última línea produce</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Problem</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">follow</span> <span class="n">DCP</span> <span class="n">rules</span><span class="o">.</span> <span class="n">Specifically</span><span class="p">:</span> <span class="n">The</span> <span class="n">objective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">DCP</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>En la liga de <a class="reference external" href="https://www.cvxpy.org/examples/index.html">ejemplos</a> hay muchos problemas típicos en optimización convexa.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="metodos-de-descenso-para-funciones-convexas">
<h2>Métodos de descenso para funciones convexas<a class="headerlink" href="#metodos-de-descenso-para-funciones-convexas" title="Permalink to this headline">¶</a></h2>
<p>En lo siguiente se asume que <span class="math notranslate nohighlight">\(f_o\)</span> cumple <span class="math notranslate nohighlight">\(f_o \in \mathcal{C}^2(\text{dom}f_o)\)</span> y es convexa en un conjunto convexo y cerrado que contiene a <span class="math notranslate nohighlight">\(x^*\)</span>. Ver <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#cacci"><span class="std std-ref">conjunto abierto, cerrado, cerradura e interior</span></a> para definición de conjunto cerrado.</p>
<div class="section" id="secuencia-de-minimizacion">
<h3>Secuencia de minimización<a class="headerlink" href="#secuencia-de-minimizacion" title="Permalink to this headline">¶</a></h3>
<p>Una gran cantidad de problemas de optimización utilizan métodos iterativos para calcular una secuencia de puntos <span class="math notranslate nohighlight">\(x^{(0)}, x^{(1)}, \dots \in \text{dom}f_o\)</span> nombrados <strong>secuencia de minimización</strong> con la característica <span class="math notranslate nohighlight">\(f_o(x^{(k)}) \rightarrow p^*\)</span> si <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span>. Tales métodos se conocen con el nombre de <strong>métodos de descenso</strong>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que si <span class="math notranslate nohighlight">\(f_o\)</span> es fuertemente convexa en el conjunto <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> entonces <span class="math notranslate nohighlight">\(\nabla^2 f_o (x) \in \mathbb{S}_{++}\)</span> y <span class="math notranslate nohighlight">\(\text{cond}(\nabla ^2 f_o(x))\)</span> está acotado por arriba por una constante para <span class="math notranslate nohighlight">\(x \in \mathcal{S}\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Se les nombra métodos de descenso pues para la secuencia de minimización se cumple la desigualdad: <span class="math notranslate nohighlight">\(f_o(x^{(k+1)}) &lt; f_o(x^{(k)})\)</span>, excepto para <span class="math notranslate nohighlight">\(x^{(k)}\)</span> óptimo.</p></li>
<li><p>Para las secuencias de minimización se asume:</p>
<ul>
<li><p>Los puntos iniciales <span class="math notranslate nohighlight">\(x^{(0)}\)</span> de los métodos iterativos están en <span class="math notranslate nohighlight">\(\text{dom}f_o\)</span>.</p></li>
<li><p>Que el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel sea cerrado pues así se garantiza que la secuencia de minimización está en el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel para todas las iteraciones y con la suposición que <span class="math notranslate nohighlight">\(f_o\)</span> sea fuertemente convexa en el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel se tienen resultados revisados en <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#dpocfc"><span class="std std-ref">definición de problemas de optimización, conjuntos y funciones convexas</span></a>.</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="paso-o-direccion-de-busqueda-y-tamano-o-longitud-de-paso">
<h3>Paso o dirección de búsqueda y tamaño o longitud de paso<a class="headerlink" href="#paso-o-direccion-de-busqueda-y-tamano-o-longitud-de-paso" title="Permalink to this headline">¶</a></h3>
<p>La secuencia de minimización se obtiene con la fórmula: <span class="math notranslate nohighlight">\(x^{(k+1)} = x^{(k)} + t^{(k)}\Delta x^{(k)}\)</span>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Al vector <span class="math notranslate nohighlight">\(\Delta x \in \mathbb{R}^n\)</span> se le nombra <strong>paso o dirección de búsqueda</strong>. Al escalar <span class="math notranslate nohighlight">\(t^{(k)}\)</span> se le nombra <strong>tamaño o longitud de paso</strong> y siempre es positivo salvo en el caso en que <span class="math notranslate nohighlight">\(x^{(k)}\)</span> sea óptimo.</p>
</div>
</div>
<div class="section" id="condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso">
<h3>Condición para que un paso o dirección de búsqueda sea de descenso<a class="headerlink" href="#condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Si el paso o dirección de búsqueda satisface la condición: <span class="math notranslate nohighlight">\(\nabla f_o^T(x^{(k)})\Delta x^{(k)} &lt; 0\)</span> se le nombra <strong>dirección de descenso</strong>.</p>
</div>
<p>Geométricamente las direcciones de descenso forman un <strong>ángulo agudo</strong> con <span class="math notranslate nohighlight">\(-\nabla f_o(x^{(k)})\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/o3hypqiociye9jv/zone-for-descent-directions.png?dl=0" heigth="350" width="350"><p>En el dibujo <span class="math notranslate nohighlight">\(f = f_o\)</span>.</p>
</div>
<div class="section" id="algoritmo-metodo-general-de-descenso-para-funciones-convexas">
<h3>Algoritmo: método general de descenso para funciones convexas<a class="headerlink" href="#algoritmo-metodo-general-de-descenso-para-funciones-convexas" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los pasos de un algoritmo representan una guía para la implementación, no implica que se tengan que implementar uno a continuación del otro como se describe. Si una implementación respeta la lógica y al mismo algoritmo, entonces pueden seguirse los pasos de una forma distinta.</p>
</div>
<blockquote>
<div><p><strong>Dado</strong> un <strong>punto inicial</strong> <span class="math notranslate nohighlight">\(x\)</span> en <span class="math notranslate nohighlight">\(\text{dom}f_o\)</span></p>
<p><strong>Repetir</strong> el siguiente bloque para <span class="math notranslate nohighlight">\(k=0,1,2,...\)</span></p>
<blockquote>
<div><ol class="simple">
<li><p>Determinar una dirección de descenso <span class="math notranslate nohighlight">\(\Delta x\)</span>.</p></li>
<li><p>Búsqueda de línea. Elegir un tamaño de paso <span class="math notranslate nohighlight">\(t &gt; 0\)</span>.</p></li>
<li><p>Hacer la actualización: <span class="math notranslate nohighlight">\(x = x + t\Delta x\)</span>.</p></li>
</ol>
</div></blockquote>
<p><strong>hasta</strong> convergencia (satisfacer criterio de paro).</p>
</div></blockquote>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Un rayo es el conjunto definido por <span class="math notranslate nohighlight">\(\{x + \theta v : \theta \geq 0 , v \neq 0, v \in \mathbb{R}^n\}\)</span> para <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>.</p>
<img src="https://dl.dropboxusercontent.com/s/l3z9j49ldzknmif/ej_rayo.png?dl=0" heigth="200" width="200">
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios.</p>
<ul class="simple">
<li><p>El algoritmo termina si <span class="math notranslate nohighlight">\(f_o(x^{(k)})-p^* \leq \epsilon\)</span> con <span class="math notranslate nohighlight">\(\epsilon &gt;0\)</span> una tolerancia dada, esto es, <span class="math notranslate nohighlight">\(x^{(k)}\)</span> es <span class="math notranslate nohighlight">\(\epsilon\)</span>-subóptimo.</p></li>
<li><p>Ejemplos de direcciones de descenso se tienen:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\Delta x = - \nabla f_o \left (x^{(k)} \right )\)</span> que da lugar al método de descenso en gradiente para <span class="math notranslate nohighlight">\(x^{(k)}\)</span> no óptimo.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x = - \nabla^2 f_o \left (x^{(k)} \right )^{-1} \nabla f_o\left(x^{(k)} \right)\)</span> que da lugar al método de descenso por Newton con <span class="math notranslate nohighlight">\(\nabla^2 f_o \left (x^{(k)} \right ) \in \mathbb{S}_{++}\)</span> y <span class="math notranslate nohighlight">\(x^{(k)}\)</span> no óptimo.</p></li>
</ul>
</li>
<li><p>El criterio de paro típicamente es de la forma <span class="math notranslate nohighlight">\(||\nabla f_o(x)|| \leq \text{TOL}\)</span> donde: <span class="math notranslate nohighlight">\(\text{TOL}\)</span> es una cantidad pequeña y positiva (menor o igual a <span class="math notranslate nohighlight">\(10^{-8}\)</span>). También se involucra el número máximo de iteraciones en el criterio de paro.</p></li>
<li><p>El paso <span class="math notranslate nohighlight">\(2\)</span> busca reducir <span class="math notranslate nohighlight">\(f_o\)</span> lo <strong>suficiente</strong> o minimizarla aproximadamente a lo largo de un <strong>rayo</strong>. Uno de los métodos que permite de forma sencilla lo anterior es la <strong>búsqueda de línea por <a class="reference external" href="https://en.wikipedia.org/wiki/Backtracking_line_search"><em>backtracking</em></a></strong>.</p></li>
</ul>
</div>
</div>
<div class="section" id="ejemplo-de-funcion-objetivo-convexa">
<h3>Ejemplo de función objetivo convexa<a class="headerlink" href="#ejemplo-de-funcion-objetivo-convexa" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^4} (x_1-2)^2+(2-x_2)^2+x_3^2+x_4^4\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2, x3, x4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡                              3⎤
⎣2⋅x₁ - 4  2⋅x₂ - 4  2⋅x₃  4⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡2  0  0    0   ⎤
⎢               ⎥
⎢0  2  0    0   ⎥
⎢               ⎥
⎢0  0  2    0   ⎥
⎢               ⎥
⎢              2⎥
⎣0  0  0  12⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<p>Como <span class="math notranslate nohighlight">\(f_o\)</span> es una función convexa (de hecho <strong>estrictamente convexa</strong>) en su dominio <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>, se tiene que su óptimo se obtiene igualando y resolviendo la <strong>ecuación no lineal</strong> <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_o(x) = 
\left[ \begin{array}{c}
2x_1-4 \\
2x_2-4\\
2x_3\\
4x_4^3
\end{array}
\right]
= 0
\end{split}\]</div>
<p>El óptimo <span class="math notranslate nohighlight">\(x^* \in \mathbb{R}^4\)</span> está dado por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x^*=
\left[ \begin{array}{c}
2\\
2\\
0\\
0
\end{array}
\right]
\end{split}\]</div>
<p><strong>¿Cómo encontramos numéricamente el óptimo?</strong></p>
<p><strong>Opción descenso en gradiente</strong>: usando el algoritmo con dirección de descenso el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> sin búsqueda de línea se tiene:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - \nabla f_o(x^{(k)})\]</div>
<p>Tomando <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0 \\ \end{array} \right ]\)</span> como punto inicial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                              <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                              <span class="s2">&quot;x3&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                              <span class="s2">&quot;x4&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span> <span class="k">for</span> <span class="n">partial_derivative</span> <span class="ow">in</span> <span class="n">gf</span><span class="p">],</span>
                              <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-1. -1. -1.  0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_2</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[5. 5. 1. 0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_3</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-1. -1. -1.  0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_4</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[5. 5. 1. 0.]
</pre></div>
</div>
</div>
</div>
<p>y aquí nos quedaremos ciclando hasta el infinito…</p>
<p><strong>Opción descenso por dirección de Newton:</strong> usando el algoritmo con dirección de descenso de Newton de <span class="math notranslate nohighlight">\(f_o\)</span> sin búsqueda de línea se tiene:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - \nabla^2 f_o \left (x^{(k)} \right )^{-1} \nabla f_o\left(x^{(k)} \right)\]</div>
<p>Tomando <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0 \\ \end{array} \right ]\)</span> como punto inicial y <strong>no calculando la inversa</strong> de la Hessiana pues en su lugar resolvemos el sistema de ecuaciones lineales <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(k)} \right ) \Delta x = - \nabla f_o \left(x^{(k)}\right )\)</span> resulta</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                              <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                              <span class="s2">&quot;x3&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                              <span class="s2">&quot;x4&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">Hf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡2.0  0.0  0.0  0.0⎤
⎢                  ⎥
⎢0.0  2.0  0.0  0.0⎥
⎢                  ⎥
⎢0.0  0.0  2.0  0.0⎥
⎢                  ⎥
⎣0.0  0.0  0.0  0.0⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡6.0⎤
⎢   ⎥
⎢6.0⎥
⎢   ⎥
⎢2.0⎥
⎢   ⎥
⎣0.0⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>El sistema de <strong>ecuaciones lineales</strong> a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{cccc}
2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}
\right ]
\Delta x = 
-\left [
\begin{array}{c}
6 \\
6 \\
2 \\
0
\end{array}
\right ]
\end{split}\]</div>
<p><strong>Obsérvese que la última ecuación es redundante</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">gf_sympy_eval</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{x₁: -3.0, x₂: -3.0, x₃: -1.0}
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(4a\)</span> ecuación redundante y por tanto <span class="math notranslate nohighlight">\(x_4 = 0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[2 2 0 0]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<p>De acuerdo al ejemplo anterior:</p>
<ul class="simple">
<li><p>Utilizar información de primer o segundo orden nos ayuda a encontrar óptimo(s) de funciones.</p></li>
<li><p>Encontrar al óptimo involucró un método iterativo.</p></li>
<li><p>En términos coloquiales y de forma simplificada, una <strong>dirección de descenso</strong> es aquella que al moverse de un punto a otro en tal dirección, el valor de <span class="math notranslate nohighlight">\(f_o\)</span> decrece (en lo que sigue <span class="math notranslate nohighlight">\(f = f_o\)</span>):</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/25bmebx645howjw/direccion_de_descenso_de_Newton_1d.png?dl=0" heigth="600" width="600">
<p>En el dibujo anterior <span class="math notranslate nohighlight">\(\hat{f}\)</span> es un modelo cuadrático, <span class="math notranslate nohighlight">\(\Delta x_{nt}\)</span> es dirección de descenso de Newton y <span class="math notranslate nohighlight">\(x^*\)</span> es el óptimo de <span class="math notranslate nohighlight">\(f\)</span>. Del punto <span class="math notranslate nohighlight">\((x,f(x))\)</span> nos debemos mover al punto <span class="math notranslate nohighlight">\((x+\Delta x_{nt}, f(x + \Delta x_{nt}))\)</span> para llegar al óptimo y el valor de <span class="math notranslate nohighlight">\(f\)</span> decrece: <span class="math notranslate nohighlight">\(f(x+\Delta x_{nt}) &lt; f(x)\)</span>.</p>
<ul class="simple">
<li><p>Con la información de primer orden no alcanzamos al óptimo (de hecho se cicla el método iterativo propuesto) pero con la de segundo orden sí lo alcanzamos en una iteración y tuvimos que resolver un sistema de ecuaciones lineales.</p></li>
</ul>
</div>
<p><strong>Opción descenso en gradiente:</strong> usando el algoritmo con dirección de descenso el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> con búsqueda de línea se tiene:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - t^{(k)}\nabla f_o(x^{(k)})\]</div>
<p>para <span class="math notranslate nohighlight">\(t^{(k)} &gt; 0\)</span>. Con <span class="math notranslate nohighlight">\(t^{(0)}=0.5\)</span> llegamos al óptimo en una iteración:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_0</span><span class="o">=</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">-</span> <span class="n">t_0</span><span class="o">*</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[2. 2. 0. 0.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>El gradiente involucra menos almacenamiento en memoria que el almacenamiento de la Hessiana: <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> vs <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span>.</p>
</div>
<p><strong>Opción usando cvxpy…</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">2</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>7.031418247836792e-48
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status:&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal value&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal var&quot;</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x4</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>status: optimal
optimal value 7.031418247836792e-48
optimal var 2.0 2.0 0.0 0.0
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="metodo-de-busqueda-de-linea-por-backtracking">
<h2>Método de búsqueda de línea por <em>backtracking</em><a class="headerlink" href="#metodo-de-busqueda-de-linea-por-backtracking" title="Permalink to this headline">¶</a></h2>
<p>En esta sección consideramos <span class="math notranslate nohighlight">\(f = f_o\)</span>.</p>
<p>Para entender el método de búsqueda de línea por <em>backtracking</em> supóngase que <span class="math notranslate nohighlight">\(f\)</span> tiene una forma siguiente:</p>
<img src="https://dl.dropboxusercontent.com/s/0woqoj8foo5eco9/level_set_of_func.png?dl=0" heigth="300" width="300">
<p>Y considérese una función <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> igual a <span class="math notranslate nohighlight">\(f\)</span> pero restringida al rayo <span class="math notranslate nohighlight">\(x + t\Delta x\)</span>, esto es: <span class="math notranslate nohighlight">\(g(t) = f(x+t \Delta x)\)</span> con <span class="math notranslate nohighlight">\(t&gt;0\)</span>, <span class="math notranslate nohighlight">\(\Delta x\)</span> dirección de descenso. Lo anterior se visualiza como sigue:</p>
<img src="https://dl.dropboxusercontent.com/s/18udjmzmmd7drrz/line_search_backtracking_1.png?dl=0" heigth="300" width="300"><div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese en el dibujo que <span class="math notranslate nohighlight">\(\nabla f(x) \neq 0\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#ejrestriccionalinea"><span class="std std-ref">ejemplo</span></a> de la nota <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">Definición de función, continuidad y derivada</span></a> para expresión de la derivada <span class="math notranslate nohighlight">\(g'(t)\)</span>.</p>
</div>
<p>Y como <span class="math notranslate nohighlight">\(f\)</span> es continua y diferenciable, <span class="math notranslate nohighlight">\(g\)</span> también lo es y <span class="math notranslate nohighlight">\(g(0)=f(x)\)</span>, <span class="math notranslate nohighlight">\(g'(t) = \nabla f(x+t\Delta x)^T \Delta x\)</span>. Si graficamos <span class="math notranslate nohighlight">\(g\)</span> se tendría:</p>
<img src="https://dl.dropboxusercontent.com/s/sgj7eqr2qysi8hs/line_search_backtracking_2.png?dl=0" heigth="300" width="300">
<p>En la búsqueda de línea se construyen dos rectas. Una recta es <span class="math notranslate nohighlight">\(g(0) + \alpha g'(0)(t-0)\)</span> con <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span>. La otra recta es <span class="math notranslate nohighlight">\(g(0)+g'(0)(t-0)\)</span>. Ambas rectas tienen pendiente negativa. Esto se visualiza como sigue:</p>
<img src="https://dl.dropboxusercontent.com/s/11y008lq0fd6jl6/line_search_backtracking_3.png?dl=0" heigth="500" width="500">
<p>En la búsqueda de línea por backtracking se busca <span class="math notranslate nohighlight">\(t^{(k)}\)</span> tal que <span class="math notranslate nohighlight">\(f\)</span> decrezca suficientemente. Lo anterior se establece con la desigualdad <span class="math notranslate nohighlight">\(f(x+t \Delta x) &lt; f(x) + \alpha t \nabla f(x)^T \Delta x\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/o4f341x1y5sqxt8/line_search_backtracking_4.png?dl=0" heigth="500" width="500">
<p>obsérvese en el dibujo anterior que la región en la que se elegirá <span class="math notranslate nohighlight">\(t^{(k)}\)</span> está a la izquierda de la línea punteada vertical de color verde.</p>
<p>Y visualmente en <span class="math notranslate nohighlight">\(R^3\)</span> se tiene:</p>
<img src="https://dl.dropboxusercontent.com/s/t3yn7kkpd4il8hx/line_search_backtracking_5.png?dl=0" heigth="300" width="300">
<p>El método depende de dos constantes <span class="math notranslate nohighlight">\(\alpha\)</span> y <span class="math notranslate nohighlight">\(\beta\)</span> con <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span> y <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span>.</p>
<div class="section" id="algoritmo-busqueda-de-linea-por-backtracking">
<h3>Algoritmo: búsqueda de línea por <em>backtracking</em><a class="headerlink" href="#algoritmo-busqueda-de-linea-por-backtracking" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>Dados</strong> <span class="math notranslate nohighlight">\(\Delta x\)</span> dirección de descenso para <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span>, <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span>, <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span>.</p>
<p><strong>Asignar</strong> t=1.</p>
<p><strong>Mientras</strong> <span class="math notranslate nohighlight">\(f(x+t\Delta x) &gt; f(x) + \alpha t \nabla f(x) ^T\Delta x\)</span>.</p>
<blockquote>
<div><ol class="simple">
<li><p><strong>Reducir</strong> <span class="math notranslate nohighlight">\(t: t= \beta t\)</span>.</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El valor <span class="math notranslate nohighlight">\(\alpha\)</span> típicamente se elige entre <span class="math notranslate nohighlight">\(.01\)</span> y <span class="math notranslate nohighlight">\(.03\)</span> que indica que se acepta un decrecimiento en el valor de <span class="math notranslate nohighlight">\(f\)</span> entre el <span class="math notranslate nohighlight">\(1 \%\)</span> y el <span class="math notranslate nohighlight">\(30 \%\)</span>. La constante <span class="math notranslate nohighlight">\(\beta\)</span> comúnmente se elige entre <span class="math notranslate nohighlight">\(.1\)</span> (que modifica fuertemente <span class="math notranslate nohighlight">\(t\)</span>) y <span class="math notranslate nohighlight">\(.8\)</span> (que realiza una modificación menos drástica de <span class="math notranslate nohighlight">\(t\)</span>).</p></li>
<li><p>Obsérvese que la multiplicación <span class="math notranslate nohighlight">\(\nabla f(x)^T \Delta x\)</span> es una derivada direccional, ver <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">definición de función, continuidad y derivada</span></a>.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="funcion-en-python-para-el-metodo-de-backtracking">
<h2>Función en Python para el método de <em>backtracking</em><a class="headerlink" href="#funcion-en-python-para-el-metodo-de-backtracking" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">line_search_by_backtracking</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">dir_desc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span>
                                <span class="n">der_direct</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">15</span><span class="p">,</span> <span class="n">beta</span><span class="o">=.</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line search that sufficiently decreases f restricted to a ray in the direction dir_desc.</span>
<span class="sd">    Args:</span>
<span class="sd">        alpha (float): parameter in line search with backtracking, tipically .15</span>
<span class="sd">        beta (float): parameter in line search with backtracking, tipically .5</span>
<span class="sd">        f (lambda expression): definition of function f.</span>
<span class="sd">        dir_desc (array): descent direction.</span>
<span class="sd">        x (array): numpy array that holds values where line search will be performed.</span>
<span class="sd">        der_direct (float): directional derivative of f.</span>
<span class="sd">    Returns:</span>
<span class="sd">        t (float): positive number for stepsize along dir_desc that sufficiently decreases f.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha must be less than or equal to 1/2&quot;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">beta</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta must be less than 1&quot;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>   
    <span class="k">if</span> <span class="n">t</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">eval1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">dir_desc</span><span class="p">)</span>
        <span class="n">eval2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">der_direct</span>
        <span class="k">while</span> <span class="n">eval1</span> <span class="o">&gt;</span> <span class="n">eval2</span><span class="p">:</span>
            <span class="n">t</span><span class="o">=</span><span class="n">beta</span><span class="o">*</span><span class="n">t</span>
            <span class="n">eval1</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">dir_desc</span><span class="p">)</span>
            <span class="n">eval2</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">der_direct</span>
    <span class="k">return</span> <span class="n">t</span>
</pre></div>
</div>
<p><strong>Preguntas de comprehensión.</strong></p>
<ol class="simple">
<li></li>
</ol>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2009.</p></li>
<li></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./III.optimizacion_convexa/3.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" title="previous page">3.1 Definición de problemas de optimización, conjuntos y funciones convexas</a>
    <a class='right-next' id="next-link" href="../3.3/Ecuaciones_no_lineales.html" title="next page">3.3 Ecuaciones no lineales</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>